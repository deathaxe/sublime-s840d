%YAML 1.2
# The MIT License (MIT)
#
# Copyright (c) 2016 DeathAxe <deathaxe82@googlemail.com>
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to
# deal in the Software without restriction, including without limitation the
# rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
# sell copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in
# all copies or substantial portions of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
# AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
# LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
# FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
# IN THE SOFTWARE.
###############################################################################
---

# http://facelessuser.github.io/sublime-markdown-popups/textmate_scopes/
# https://manual.macromates.com/en/language_grammars#naming_conventions
# https://www.sublimetext.com/docs/3/scope_naming.html
name: S840D G-Code
file_extensions:
  - def
  - mpf
  - spf
  - tea
first_line_match: (?i:PROC|%_N_[\w_]+_(?:[MS]PF|INI|DEF|TEA)|;VERSION\:\s*\d+\.\d+\.\d+\.\d+)\b
scope: source.s840d_gcode

###############################################################################

variables:
  # axis
  # REM: AC is not an axis
  #      AX is a general axis identifier
  #      VX is a custom positioning axis
  axis: (?:[BCEQUWXYZ]C?|AX?|V[ABCXYZ]?)
  # loating point values
  float: (?:\d+\.?\d*|\.\d+)(?:EX[-+]?\d{1,2})?
  # normal identifiers start with 2 letters or '_' optinally followed by :alnum:
  ident: '\b[A-Za-z_]{2}\w*\b'
  # macro names start with letter or '_' optinally followed by :alnum:
  macro: '\b[A-Za-z_]\w+\b'
  # labels must start with 2 letters or '_' optinally followed by :alnum:
  label: '[A-Za-z_]{2}\w*\b'
  # cycle names or ISO cylce L0815
  cycle: (?:[A-Za-z][A-Za-z_]\w*|L\d+)\b
  # procedure attributes
  proc_attr: (?i:ACTBLOCNO|DISPLO[NF]|ICYCO[FN]|IPTRLOCK|IPTRUNLOCK|PREPRO|SAVE|SBLO[FN])\b

###############################################################################
# MAIN CONTEXT
###############################################################################

contexts:

  main:
    - include: iso-blockno
    - include: comment-disabled
    - match: (\w+)(:)|(?=\S)
      captures:
        1: entity.name.tag.label.s840d_gcode
        2: punctuation.terminator.tag.label.s840d_gcode
      push:
        - include: line-end
        - include: definitions
        # match incomplete keyword DEF or DEFINE
        # to avoid to set main-sublevel too early
        - match: (?i:DE?F?I?N?E?)\b
          scope: keyword.control.define.s840d_gcode
        - match: (?=\S)
          set: main-sublevel

  main-sublevel:
    - include: iso-blockno
    - include: comment-disabled
    - match: (\w+)(:)|(?=\S)
      captures:
        1: entity.name.tag.label.s840d_gcode
        2: punctuation.terminator.tag.label.s840d_gcode
      push:
        - include: line-end
        - include: statements

###############################################################################
# COMMON PROTOTYPES
###############################################################################

  line-end:
    - match: \n
      scope: meta.eol.s840d_gcode
      pop: true
    - include: comment-line

  assert-line-end:
    - include: line-end
    # mark rest of the line as illegal beginning with the first
    # none whitespace letter
    - match: \S.*?(?=[ \t]*;)
      scope: invalid.illegal.s840d_gcode
      pop: true

  line-end-or-illegal:
    - include: line-end
    - include: illegal

  scope-end:
    - match: (?=\S)|$
      pop: true

  after-operator:
    - match: '[-+]'
      scope: constant.numeric.s840d_gcode
      pop: true
    - include: axis-variables
    - include: scope-end

  seperator-comma:
    - match: ','
      scope: punctuation.separator.comma.s840d_gcode

  seperator-comma-minus:
    - match: ','
      scope: punctuation.separator.comma.s840d_gcode
      push: after-operator

###############################################################################
# DEFINITIONS
###############################################################################

  definitions:
    - include: stmt-def
    - include: stmt-define
    - include: stmt-redef
    - include: stmt-proc
    - include: stmt-extern

###############################################################################
# EXTERN PROCEDURE DEFINITION
# TESTS: syntax_test_extern.spf
###############################################################################

  stmt-extern:
    - match: (?i:EXTERN)\b
      scope: meta.function.s840d_gcode keyword.control.extern.s840d_gcode
      set: stmt-extern-name

  stmt-extern-name:
    - meta_content_scope: meta.function.name.s840d_gcode
    - match: '{{cycle}}'
      scope: variable.function.cycle.s840d_gcode
      set:
        - meta_content_scope: meta.function.name.s840d_gcode
        - match: (?=\()
          set: stmt-extern-parameters
        - include: line-end-or-illegal
    - include: line-end-or-illegal

  stmt-extern-parameters:
    - match: \(
      scope: punctuation.section.parameters.begin.s840d_gcode
      set:
        - meta_scope: meta.function.parameters.s840d_gcode
        - match: \)
          scope: punctuation.section.parameters.end.s840d_gcode
          set: line-end-or-illegal
        - include: seperator-comma
        - include: storage-types
        - include: storage-modifiers
        - include: line-end-or-illegal
    - include: line-end-or-illegal

###############################################################################
# PROCEDURE DEFINITION
# TESTS: syntax_test_proc.spf
###############################################################################

  stmt-proc:
    - match: (?i:PROC)\b
      scope: meta.function.s840d_gcode keyword.control.proc.s840d_gcode
      set: stmt-proc-name

  stmt-proc-name:
    - meta_content_scope: meta.function.name.s840d_gcode
    - match: '{{cycle}}'
      scope: entity.name.function.s840d_gcode
      set:
        - meta_content_scope: meta.function.name.s840d_gcode
        - match: (?=\()
          set: stmt-proc-parameters
        - match: (?={{proc_attr}})
          set: stmt-proc-attributes
        - include: line-end-or-illegal
    - include: line-end-or-illegal

  stmt-proc-parameters:
    - match: \(
      scope: punctuation.section.parameters.begin.s840d_gcode
      set:
        - meta_scope: meta.function.parameters.s840d_gcode
        - match: \)
          scope: punctuation.section.parameters.end.s840d_gcode
          set: stmt-proc-attributes
        - include: seperator-comma
        - include: storage-types
        - include: storage-modifiers
        - include: constants
        - include: operators-assignment
        - include: illegal-operators
        - match: '{{ident}}'
          scope: variable.parameter.procedure.s840d_gcode
          push: array-dimension
        - include: line-end-or-illegal
    - include: line-end-or-illegal

  stmt-proc-attributes:
    - meta_content_scope: meta.function.attributes.s840d_gcode
    - match: '{{proc_attr}}'
      scope: storage.modifier.function.s840d_gcode
    - include: line-end-or-illegal

###############################################################################
# MACRO DEFINITION
# TESTS: syntax_test_define.spf
###############################################################################

  stmt-define:
    - match: (?i:DEFINE)\b
      scope: keyword.control.define.s840d_gcode
      set:
        - meta_scope: meta.definition.macro.s840d_gcode
        - match: '{{macro}}'
          scope: entity.name.macro.s840d_gcode
          set: stmt-define-as
        - match: (?=\S)
          set: stmt-define-as
        - include: line-end-or-illegal

  stmt-define-as:
    - meta_content_scope: meta.definition.macro.s840d_gcode
    - match: (?i:AS)\b
      scope: keyword.control.as.s840d_gcode
      set: stmt-define-action
    - include: line-end-or-illegal

  stmt-define-action:
    - meta_content_scope: meta.definition.macro.action.s840d_gcode
    - match: \n
      scope: meta.definition.macro.action.s840d_gcode meta.eol.s840d_gcode
      pop: true
    # make sure all statements are scoped with meta.definition.macro.action
    - match: (?=\S)
      push: statements
      with_prototype:
        # make sure to pop off before line end from all statements
        - match: $
          pop: true

###############################################################################
# VARIABLE DEFINITION
# TESTS: syntax_test_def.spf
###############################################################################

  stmt-def:
    - match: (?i:DEF)\b
      scope: meta.definition.variable.s840d_gcode keyword.control.def.s840d_gcode
      set:
        - meta_content_scope: meta.definition.variable.storage.s840d_gcode
        - include: storage-modifier-scope
        - include: storage-modifier-access
        - include: storage-modifier-init
        - include: storage-modifier-limits
        - include: storage-modifier-sync
        - include: storage-modifier-unit
        - include: storage-types
        - match: (?=\S)
          set: stmt-def-operand
        - include: line-end

  stmt-def-operand:
    - meta_content_scope: meta.definition.variable.operand.s840d_gcode
    - match: '{{ident}}'
      scope: variable.other.s840d_gcode
      set: [stmt-def-value, array-dimension]
    - include: stmt-def-end

  stmt-def-value:
    - meta_content_scope: meta.definition.variable.operand.s840d_gcode
    - match: (?==)
      set: stmt-def-value-body
    - include: stmt-def-end

  stmt-def-value-body:
    - meta_content_scope: meta.definition.variable.value.s840d_gcode
    - match: \(
      scope: meta.group.s840d_gcode punctuation.section.group.begin.s840d_gcode
      set:
        - meta_content_scope: meta.group.s840d_gcode meta.definition.variable.value.s840d_gcode
        - match: \)
          scope: punctuation.section.group.end.s840d_gcode
          set: stmt-def-end
        - include: seperator-comma-minus
        - include: expressions
    - include: expressions
    - include: stmt-def-end

  stmt-def-end:
    - meta_content_scope: meta.definition.variable.s840d_gcode
    - match: ','
      scope: punctuation.separator.comma.s840d_gcode
      set: stmt-def-operand
    - include: line-end-or-illegal

###############################################################################
# VARIABLE REDEFINITION
# TESTS: syntax_test_redef.spf
###############################################################################

  stmt-redef:
    - match: (?i:REDEF)\b
      scope: keyword.control.redef.s840d_gcode
      set:
        - meta_scope: meta.redefinition.s840d_gcode
        - include: storage-modifier-access
        - include: storage-modifier-init
        - include: storage-modifier-sync
        - include: storage-modifier-limits
        - include: variables
        - include: line-end-or-illegal

###############################################################################
# STATEMENTS
###############################################################################

  statements:
    - include: iso-gcode    # added here to increase G-Code performance by 9%
    - include: stmt-case
    - include: stmt-if
    - include: stmt-goto
    - include: stmt-gotos
    - include: stmt-for
    - include: stmt-loop
    - include: stmt-while
    - include: stmt-stopre
    - include: stmt-repeat
    - include: stmt-call
    - include: stmt-isocall
    - include: stmt-modalcall
    - include: stmt-pathcall
    - include: stmt-synact
    - include: stmt-ret
    - include: stmt-ctab
    - include: stmt-setint
    - include: stmt-procedure-call
    - include: stmt-cycle-call
    - include: stmt-iso

###############################################################################
# CALL
# TESTS: syntax_test_call.spf
###############################################################################

  stmt-call:
    - match: (?i:CALL)\b
      scope: meta.function-call.s840d_gcode keyword.control.call.s840d_gcode
      set:
        - meta_content_scope: meta.function-call.name.s840d_gcode
        # first statement is BLOCK
        - match: (?=(?i:BLOCK)\b)
          set: stmt-call-block
        # match single ident as function name
        - match: '{{ident}}(?=\s*[\(\w])'
          scope: variable.other.s840d_gcode
          set:
            - meta_content_scope: meta.function-call.name.s840d_gcode
            - match: (?=(?i:BLOCK)\b)
              set: stmt-call-block
            - include: stmt-call-end
        # function name is built inplace using normal expressions
        - match: (?=\S)
          set:
            - meta_content_scope: meta.function-call.name.s840d_gcode
            - match: (?=(?i:BLOCK)\b)
              set: stmt-call-block
            - include: stmt-call-or-expressions
        - include: line-end

  stmt-call-block:
    - match: (?i:BLOCK)\b
      scope: keyword.control.block.s840d_gcode
      set:
        - meta_scope: meta.function-call.block.begin.s840d_gcode
        - match: (?=(?i:TO)\b)
          set: stmt-call-to
        - match: ([Nn]\d+)\b[ \t]*
          captures:
            1: variable.language.blockno.s840d_gcode
          set: stmt-call-to
        - include: stmt-call-or-expressions
    - include: stmt-call-end

  stmt-call-to:
    - match: (?i:TO)\b
      scope: keyword.control.to.s840d_gcode
      set:
        - meta_scope: meta.function-call.block.end.s840d_gcode
        - match: '[Nn]\d+\b'
          scope: variable.language.blockno.s840d_gcode
          set: stmt-call-end
        - include: stmt-call-or-expressions
    - include: stmt-call-end

  stmt-call-or-expressions:
    - match: (?=(?i:CALL)\b)
      set: stmt-call
    - include: expressions
    - include: line-end
    - include: illegal-ident

  stmt-call-end:
    # several call statements are allowed in one line.
    - match: (?=(?i:CALL)\b)
      set: stmt-call
    - include: line-end
    - include: illegal-ident

###############################################################################
# ISOCALL
# TESTS: syntax_test_isocall.spf
###############################################################################

  stmt-isocall:
    - match: (?i:ISOCALL)\b
      scope: meta.function-call.s840d_gcode keyword.control.isocall.s840d_gcode
      set:
        - meta_content_scope: meta.function-call.name.s840d_gcode
        - match: '{{ident}}(?=\s*[\(\w])'
          scope: variable.other.s840d_gcode
          set: line-end-or-illegal
        - match: (?=\S)
          set:
            - meta_scope: meta.function-call.name.s840d_gcode
            - include: expressions-line
        - include: line-end

###############################################################################
# MCALL
# TESTS: syntax_test_mcall.spf
###############################################################################

  stmt-modalcall:
    - match: (?i:MCALL)\b
      scope: meta.function-call.s840d_gcode keyword.control.mcall.s840d_gcode
      set:
        - meta_content_scope: meta.function-call.name.s840d_gcode
        - match: '{{cycle}}'
          scope: variable.function.cycle.s840d_gcode
          set: cycle-call-arguments
        - match: (?=\S)
          set:
            - meta_scope: meta.function-call.name.s840d_gcode
            - include: expressions-line
        - include: line-end

###############################################################################
# PCALL
# TESTS: syntax_test_pcall.spf
###############################################################################

  stmt-pathcall:
    - match: (?i:PCALL)\b
      scope: meta.function-call.s840d_gcode keyword.control.pcall.s840d_gcode
      set:
        - meta_content_scope: meta.function-call.name.s840d_gcode
        # absolute path to cycle
        - match: (?:/*\w+:)?/[/\w]+\b
          scope: string.unquoted.path.s840d_gcode
          set: cycle-call-arguments
        - match: '{{cycle}}'
          scope: variable.function.cycle.s840d_gcode
          set: cycle-call-arguments
        - match: (?=\S)
          set:
            - meta_scope: meta.function-call.name.s840d_gcode
            - include: expressions-line
        - include: line-end

###############################################################################
# SETINT(1) PRIO=4 CYCLE LIFTFAST
# TESTS: syntax_test_setint.spf
###############################################################################

  stmt-setint:
    # a special procedure which allows ISO style arguments afterwards
    - match: (?i:SETINT)\b
      scope: keyword.operator.assignment.interrupt.s840d_gcode
      set: [stmt-setint-cycle, function-call-arguments]

  stmt-setint-cycle:
    - match: (?i:PRIO)\b
      scope: support.variable.iso.address.s840d_gcode
    - match: ({{cycle}})(?i:[ \t]+(LIFTFAST\b)|[ \t]*(?=(?:$|;)))
      captures:
        1: meta.function-call.name.s840d_gcode variable.function.cycle.s840d_gcode
        2: constant.language.liftfast.s840d_gcode
      set: assert-line-end
    - include: expressions-line

###############################################################################
# PROCEDURE CALL
# TESTS: syntax_test_proc.spf
###############################################################################

  stmt-procedure-call:
    # SINUMERIK procedures
    # need to stand alone in a line
    - match: (?:A(?:DISPOSA|UXFU(?:DE(?:L|LG)|MSEQ|SYNC)|X(?:CTSW(?:E|E[CD])|TOCHAN))|BRISKA|C(?:A(?:LLPATH|NCEL)|HANDATA|L(?:EARM|RINT)|O(?:NT(?:DCON|PRON)|RROF|UP(?:DE[FL]|O(?:[FN]|FS|NC)|RES))|PRO(?:T|TDEF)|TAB(?:DE[FL]|LOCK|UNLOCK))|D(?:EL(?:AYFSTO[FN]|DTG|ETE|MT|T|TC)|ISABLE|RIVEA|ZERO)|E(?:G(?:DE[FL]|O(?:F[CS]|N|NSY(?:N|NE)))|NABLE|SR[RS]|X(?:EC(?:STRING|TAB|UTE)|T(?:C(?:ALL|LOSE)|OPEN)))|F(?:CTDEF|GROUP|ILE(?:DATE|INFO|S(?:IZE|TAT)|TIME)|P(?:[OR]|RAO[FN])|TOC)|G(?:E(?:OAX|T|T(?:D|EXET|FREELOC|SELT))|WPSO[FN])|I(?:CYCO[FN]|NIT|P(?:OBRKA|TR(?:LOCK|UNLOCK)))|JERKA|L|L(?:EADO[FN]|OCK)|M(?:ASL(?:DE[FL]|O(?:[FN]|FS))|MC|SG|VTOOL)|N(?:EWCONF|PRO(?:T|TDEF))|ORIRESET|P(?:O(?:L(?:F(?:A|M(?:ASK|LIN))|YPATH)|S(?:M|MT))|R(?:ESETO(?:N|NS)|OT[AS])|U(?:NCHACC|TFTO(?:C|CF)))|R(?:DISABLE|E(?:AD|LEASE|SE(?:T|TMON)|T|TB))|S(?:BLO[FN]|ET(?:AL|INT|M|M(?:S|TH)|PIECE|T(?:A|IA))|IREL(?:IN|OUT|TIME)|OFTA|P(?:CO[FN]|LINEPATH)|T(?:ART|OPR(?:E|EOF))|YNFCT)|T(?:AN(?:G|G(?:DEL|O[FN]))|C[AI]|LIFT|M(?:L|O[FN])|OFFO[FN]|RA(?:ANG|C(?:ON|YL)|FOOF|ILO[FN]|NSMIT|ORI))|UNLOCK|W(?:AIT(?:[CEMPS]|ENC|MC)|ORKPIECE|R(?:ITE|TPR)))\b
      scope: support.function.nck.procedure.s840d_gcode
      set: cycle-call-arguments

###############################################################################
# DIRECT CYCLE CALL
# TESTS: syntax_test_cycle.spf
###############################################################################

  stmt-cycle-call:
    # Match known ISO/NCK functions
    - include: iso-operands
    - include: iso-commands
    - include: nc-function-call
    - include: operators-arithmetic # don't match as cycle
    - include: operators-logical    # don't match as cycle
    - include: booleans             # don't match as cycle
    - include: axis-constants       # don't match as cycle
    - include: illegal-keywords     # don't match as cycle
    # A single identifier in a line is matched as a custom procedure call
    # (unknown subprogram) if it does not match any known keyword or function.
    - match: '{{cycle}}(?=[ \t]*(?:$|[;\w\(]))'
      scope: variable.function.cycle.s840d_gcode
      set: cycle-call-arguments

  cycle-call-arguments:
    - meta_scope: meta.function-call.name.s840d_gcode
    - match: (?=\()
      set: [cycle-call-arguments-body, after-operator, function-call-arguments-begin]
    - include: line-end-or-illegal

  cycle-call-arguments-body:
    - meta_scope: meta.function-call.arguments.s840d_gcode
    - match: \)
      scope: punctuation.section.arguments.end.s840d_gcode
      set:
        - include: iso-repeat-count
        - include: line-end-or-illegal
    - include: seperator-comma-minus
    - include: expressions-line

###############################################################################
# CASE ... OF 1 GOTO ... 2 GOTO ... DEFAULT ...
# TESTS: syntax_test_case.spf
###############################################################################

  stmt-case:
    - match: (?i:CASE)\b
      scope: meta.control.case.s840d_gcode keyword.control.case.s840d_gcode
      set: stmt-case-operand

  stmt-case-operand:
    - meta_content_scope: meta.control.case.operand.s840d_gcode
    - match: (?=(?i:\bOF\b))
      set: stmt-case-of
    - include: expressions-line

  stmt-case-of:
    - meta_content_scope: meta.control.case.s840d_gcode
    - match: ((?i:\bOF\b))[ \t]*
      captures:
        1: keyword.control.of.s840d_gcode
      set: [stmt-case-condition, after-operator]

  stmt-case-condition:
    - meta_content_scope: meta.control.case.condition.s840d_gcode
    - include: line-end
    - include: stmt-case-default
    - include: numbers
    - match: '(\b{{macro}})?[ \t]*(?=(?i:\bGOTO[BF]?\b))'
      captures:
        1: variable.other.s840d_gcode
      set: stmt-case-goto
    - match: \S+
      scope: invalid.illegal.goto-expected.s840d_gcode

  stmt-case-default:
    - match: ((?i:\bDEFAULT\b))[ \t]*
      captures:
        1: keyword.control.default.s840d_gcode
      set:
        - meta_content_scope: meta.control.case.goto.s840d_gcode
        - include: stmt-case-goto
        - include: assert-line-end

  stmt-case-goto:
    - meta_content_scope: meta.control.case.goto.s840d_gcode
    - match: (?i:\bGOTO[FB]?\b)
      scope: keyword.control.goto.s840d_gcode
      push: stmt-case-goto-target
    - match: (?=\S)|$
      set: [stmt-case-condition, after-operator]

  stmt-case-goto-target:
    - include: line-end
    - match: '{{label}}'
      scope: entity.name.tag.goto-label.s840d_gcode
      pop: true
    - match: '[Nn]\d+\b'
      scope: entity.name.tag.goto-block.s840d_gcode
      pop: true
    - match: \S+
      scope: invalid.illegal.label-expected.s840d_gcode
      pop: true

###############################################################################
# CURVE TABLES
# TESTS: -
###############################################################################

  stmt-ctab:
    - match: (?i:CTABDEF)\b
      scope: keyword.control.ctabdef.s840d_gcode
      set:
        - meta_scope: meta.section.ctab.s840d_gcode meta.function-call.s840d_gcode
        - match: \n|(?=;)
          set: stmt-ctab-body
        - match: (?=\()
          push: function-call-arguments

  stmt-ctab-body:
    - meta_content_scope: meta.section.ctab.s840d_gcode
    - match: (?i:CTABEND)\b
      scope: keyword.control.ctabend.s840d_gcode
      set: assert-line-end
    - include: main-sublevel

###############################################################################
# FOR .. TO ... ENDFOR
# TESTS:
###############################################################################

  stmt-for:
    - match: (?i:FOR)\b
      scope: keyword.control.for.s840d_gcode
      set:
        - meta_scope: meta.section.for.s840d_gcode meta.control.for.s840d_gcode
        - match: \n|(?=;)
          set: stmt-for-body
        - match: (?i:TO)\b
          scope: keyword.control.to.s840d_gcode
        - include: expressions
        - include: illegal

  stmt-for-body:
    - meta_content_scope: meta.section.for.s840d_gcode
    - match: (?i:ENDFOR)\b
      scope: keyword.control.endfor.s840d_gcode
      set: assert-line-end    # leave for-body
    - include: main-sublevel

###############################################################################
# GOTO
# TESTS: syntax_test_goto.spf
###############################################################################

  stmt-gotos:
    - match: (?i:GOTOS)\b
      scope: keyword.control.gotos.s840d_gcode
      set:
        - meta_scope: meta.control.goto.s840d_gcode
        - include: assert-line-end

  stmt-goto:
    - match: (?i:GOTO[FBC]?)\b
      scope: keyword.control.goto.s840d_gcode
      set: stmt-goto-target

  stmt-goto-target:
    - meta_scope: meta.control.goto.s840d_gcode
    - match: '{{label}}(?=[ \t]*(?:$|;|[Ii][Ff]\b))'
      scope: entity.name.tag.goto-label.s840d_gcode
      set: stmt-goto-end
    - match: '[Nn]\d+\b(?=[ \t]*(?:$|;|[Ii][Ff]\b))'
      scope: entity.name.tag.goto-block.s840d_gcode
      set: stmt-goto-end
    - match: (?=\S)
      set: stmt-goto-target-expression
    - include: line-end

  stmt-goto-target-expression:
    - meta_content_scope: meta.control.goto.s840d_gcode
    - include: stmt-goto-end
    - include: expressions
    - include: illegal

  stmt-goto-end:
    - include: line-end
    - match: (?=(?i:\bIF\b))
      set: stmt-if

###############################################################################
# IF ... ELSE ... ENDIF
# TESTS: syntax_test_if.spf
###############################################################################

  stmt-if:
    - match: (?i:IF)\b
      scope: keyword.control.if.s840d_gcode
      set:
        - meta_scope: meta.section.if.s840d_gcode meta.control.if.s840d_gcode
        - match: \n|(?=;)
          set: stmt-if-body
        - match: (?=(?i:GOTO[FB]?\b))
          set: stmt-goto
        - include: expressions
        - include: illegal

  stmt-if-body:
    - meta_content_scope: meta.section.if.s840d_gcode
    - match: (?i:ENDIF)\b
      scope: keyword.control.endif.s840d_gcode
      set: assert-line-end    # leave if-body
    - match: (?i:ELSE)\b
      scope: keyword.control.else.s840d_gcode
      push: assert-line-end   # don't leave if-body
    - include: main-sublevel

###############################################################################
# DIN ISO STATEMENTS
# TESTS: syntax_test_iso.spf
###############################################################################

  stmt-iso:
    - match: (?=\S)
      set: stmt-iso-body

  stmt-iso-body:
    - include: iso-gcode
    - include: iso-repeat-count
    - include: iso-operands
    - include: iso-commands
    - include: expressions-line

  iso-blockno:
    - match: N(?:\d+|$)
      scope: comment.blockno.s840d_gcode

  iso-gcode:
    # GEO axes: X/Y/Z/...
    # X2.8 | X 2.8 | X+2.8 | X-2.8 | X=2.8 | X.8 | X .8
    # channel axes: XC/YC/ZC/...
    # XC2.8 | XC 2.8 | XC+2.8 | XC-2.8 | XC=2.8 | XC.8 | XC .8
    # machine axes: X1/Y1/Z1/...
    # X2=2.8 | X2=+2.8 | X2=-2.8
    - match: '(?x)
              {{axis}}
              (?:
                \d+
                  (?:
                    [ \t]+(?=[\.\d]) |
                    [ \t]*(?=[-+=\[\(])
                  ) |
                [ \t]*(?=[-+=\.\d])
              )'
      scope: support.variable.iso.position.s840d_gcode
      push: iso-value-float
    # parameter adresses ending with letters: F FA S ...
    # F2200.5 | F 2200.5 | F=2200.5 | F = 2200.5 | F.2205 | F .2205
    # parameter adresses ending with digit: F2 S2 ...
    # F2=2200.5 | F2 = 2200.5
    - match: '(?x)
              [FIJKOS]
              (?:\d+(?=[ \t]*=)|(?=[ \t]*[-+=\.\d]))'
      scope: support.variable.iso.operand.s840d_gcode
      push: iso-value-float
    # M-function:   M2
    # H-function:   H3
    - match: '[MH]\d+'
      scope: support.function.iso.auxiliary.s840d_gcode
      push: iso-value-void2
    # G-function:   G0
    # T-function:   T100
    # D-call:       D1 DL1
    - match: (?:[GT]|DL?)\d+
      scope: support.function.iso.command.s840d_gcode
      push: iso-value-void
    # FUNCTIONS
    # G-function:   G=0
    # T-function:   T=100  T="100"
    # D-function:   D=5 DL=5
    - match: (?:[GT]|DL?)(?=[ \t]*=)
      scope: support.function.iso.command.840d_gcode
      push: iso-value-int
    # M-function:   M=20
    # H-function:   H=20
    - match: '[MH](?=[ \t]*=)'
      scope: support.function.iso.auxiliary.s840d_gcode
      push: iso-value-int
    # POSITIONS
    # machine axis:   X[0]=20
    # channel axis:   XC[10]=10
    - match: ({{axis}})[ \t]*(\[)
      captures:
        1: support.variable.iso.position.s840d_gcode
        2: punctuation.section.brackets.begin.s840d_gcode
      push: array-index-body
    # PARAMETERS
    # feed rate:      F[X1]=2000
    # spindle speed:  S[1]=20
    - match: ([FIJKOS])[ \t]*(\[)
      captures:
        1: support.variable.iso.operand.s840d_gcode
        2: punctuation.section.brackets.begin.s840d_gcode
      push: array-index-body
    # FUNCTIONS
    # G-function:   G[0]=20
    # T-function:   T[1]=10     // tool for toolholder 1
    # D-function:   D[1]=10     // active edge of toolholder 1
    - match: ([GTD])[ \t]*(\[)
      captures:
        1: support.function.iso.command.s840d_gcode
        2: punctuation.section.brackets.begin.s840d_gcode
      push: array-index-body
    # M-function:   M[10]=10
    # H-function:   H[10]=10
    - match: ([MH])[ \t]*(\[)
      captures:
        1: support.function.iso.auxiliary.s840d_gcode
        2: punctuation.section.brackets.begin.s840d_gcode
      push: array-index-body

  iso-operands:
    # SINUMERIK address parameter
    # can switch on/off internal functions
    #   e.g.: SPOS=10 | SPOS[2]=10
    - match: (?:A(?:C(?:C|CLIMA)|TOL)|C(?:OARSEA|P(?:BC|DE[FL]|F(?:M(?:O[FN]|SON)|POS|RS)|L(?:A|CTID|DE[FLN]|IN(?:SC|TR)|NUM|O(?:[FN]|UT(?:SC|TR))|POS|SETVAL)|M(?:ALARM|BRAKE|PRT|RESET|START|VDI)|O[FN]|RES|S(?:ETTYPE|YN(?:CO(?:[PV]|P2)|FI(?:[PV]|P2))))|TOL|UTMOD)|DIA(?:CYCOFA|M(?:90A|CHA(?:N|NA)|O(?:FA|NA)))|F(?:[AL]|DA|GREF|INEA|MA|O(?:C|CO[FN])|X(?:S|S[TW]))|I(?:P|POENDA)|JERKLI(?:M|MA)|LIMS|M(?:EA(?:C|SA|WA)|OV)|O(?:S|S(?:[BE]|C(?:ILL|TRL)|NSC|P[12]|T[12])|TOL|V(?:R|R(?:A|RAP)))|P(?:O|O(?:LF|S|S[AP])|RIO)|S(?:C(?:C|PARA)|PO(?:S|SA)|RA|T(?:A|AT|OLF)|VC)|T(?:OF(?:F|FL)|U)|VELOLI(?:M|MA))\b
      scope: support.variable.iso.address.s840d_gcode
      push: array-index
    # SINUMERIK command operands
    # act as arguments for iso commands
    #   e.g.: AP=10
    - match: (?:A(?:[2345PR]|DI(?:S|SPOS)|LF|NG)|B[2-5]|C(?:[2345R]|H[FR])|D(?:[0L]|I(?:LF|S(?:[CR]|CL|PR|RP)|T[ES]))|F(?:AD|[BDPZ]|R(?:C|CM))|I(?:[1R]|SD)|J[1R]|K[1R]|LEAD|M(?:EA[SW]|OVT)|O(?:FFN|MA[1-5]|RIS)|P[LW]|R(?:N(?:D|DM)|P|PL)|S(?:[DFRT]|P[NP])|T(?:CARR|HETA|ILT|OFFR|URN))\b
      scope: support.variable.iso.operand.s840d_gcode
      push: illegal-brackets-pop

  iso-commands:
    # SINUMERIK command with ISO style operands
    #   e.g.: TRANS X0 Y0.4
    - match: (?:A(?:MIRROR|RO(?:T|TS)|S(?:CALE|PLINE)|TRANS)|B(?:AUTO|NAT|RISK|SPLINE|TAN)|C(?:DO(?:[FN]|F2)|F(?:C|IN|TCP)|IP|OMP(?:C(?:AD|URV)|O[FN]|SURF)|[PT]|PRECO[FN]|SPLINE|UT(?:2(?:D|D(?:[DF]|FD))|3D(?:[CF]|C(?:[CD]|CD)|F[FS])|CONO[FN]))|D(?:IAM(?:90|CYCOF|O[FN])|R(?:FOF|IVE)|YN(?:FINISH|NORM|POS|ROUGH|SEMIFIN))|E(?:AUTO|NAT|TAN)|F(?:CUB|ENDNORM|FWO[FN]|IFOCTRL|LIN|NORM|TOCO[FN])|G(?:FRAME(?:10|[0-9])?[0-9]|ORAP)|INVC(?:CW|W)|KON(?:T|T[CT])|LF(?:O[FN]|POS|TXT|WP)|MIRROR|NORM|O(?:EMIPO[12]|RI(?:AX(?:ES|POS)|[CD]|C(?:ON(?:C(?:CW|W)|IO|TO)|URVE)|EULER|MKS|P(?:AT(?:H|HS)|LANE)|R(?:OT[ACRT]|P(?:Y|Y2))|SO[FN]|V(?:ECT|IRT[12])|WKS)|S(?:[CDST]|OF|SE))|P(?:ARO(?:T|TOF)|DELAYO[FN]|O(?:LY|N|NS)|T(?:P|P(?:G0|WOC)))|R(?:EPOS(?:[AHLQ]|HA|QA)|M(?:[BEIN]|BBL|EBL|IBL|NBL)|O(?:T|TS)|TLIO[FN])|S(?:CALE|O(?:FT|N|NS)|P(?:ATH|IF[12]|OF)|T(?:ARTFIFO|OPFIFO)|UPA)|T(?:CO(?:ABS|F(?:R|R[XYZ]))|O(?:FRAM(?:E|E[XYZ])|RO(?:T|T(?:OF|[XYZ]))|W(?:BCS|KCS|MCS|STD|TCS|WCS))|RANS)|UPATH|WAL(?:CS(?:[0-9]|10)|IMO[FN]))\b
      scope: support.function.iso.command.s840d_gcode
      push: illegal-brackets-pop

  iso-repeat-count:
    - match: P(?=[ \t]*[=\d])
      scope: support.variable.iso.repeat-count.s840d_gcode
      push: iso-value-int

  iso-value-float:
    - match: '[-+]?{{float}}'
      scope: constant.numeric.s840d_gcode
      pop: true
    - include: illegal-brackets-pop

  iso-value-int:
    - include: expressions
    - include: illegal-brackets-pop

  iso-value-void:
    # nothing but another word or comment allowed
    - match: (?=$|[ \t]*[A-Za-z;]|[ \t]+_)
      pop: true
    - include: illegal-pop

  iso-value-void2:
    # nothing but another word, comment or assignment allowed
    - match: (?=$|[ \t]*[A-Za-z;=]|[ \t]+_)
      pop: true
    - include: illegal-pop

###############################################################################
# LOOP ... ENDLOOP
# TESTS:
###############################################################################

  stmt-loop:
    - match: (?i:LOOP)\b
      scope: keyword.control.loop.s840d_gcode
      set:
        - meta_scope: meta.section.loop.s840d_gcode
        - match: \n|(?=;)
          set: stmt-loop-body
        - include: illegal

  stmt-loop-body:
    - meta_content_scope: meta.section.loop.s840d_gcode
    - match: (?i:ENDLOOP)\b
      scope: keyword.control.endloop.s840d_gcode
      set: assert-line-end    # leave loop-body
    - include: main-sublevel

###############################################################################
# REPEAT ... UNTIL / REPEAT <LBL1> <LBL2> / REPEATB <LBL>
# TESTS: syntax_test_repeat.spf
###############################################################################

  stmt-repeat:
    # REPEATB <LBL> P=<count>
    - match: (?i:REPEATB)\b
      scope: keyword.control.repeatb.s840d_gcode
      set:
        - meta_scope: meta.control.repeatb.s840d_gcode
        - match: \b({{label}})[ \t]*({{label}})?
          captures:
            1: entity.name.tag.repeat-label.s840d_gcode
            2: invalid.illegal.tag.repeat-label.s840d_gcode
          set:
            - meta_content_scope: meta.control.repeatb.s840d_gcode
            - include: iso-repeat-count
            - include: expressions-line
        - include: line-end-or-illegal

    # REPEAT ... UNTIL
    - match: (?i:REPEAT)\b(?=[ \t]*(?:$|;))
      scope: keyword.control.repeat.s840d_gcode
      set:
        - meta_scope: meta.section.repeat.s840d_gcode
        - match: \n|(?=;)
          set: stmt-repeat-body
        - include: illegal

    # REPEAT <LBL_S> <LBL_E> P=<count>
    - match: (?i:REPEAT)\b
      scope: keyword.control.repeat.s840d_gcode
      set:
        - meta_scope: meta.control.repeat.s840d_gcode
        # begin label and optional end label
        - match: \b({{label}})[ \t]*({{label}})?
          captures:
            1: entity.name.tag.repeat-label.begin.s840d_gcode
            2: entity.name.tag.repeat-label.end.s840d_gcode
          set:
            - meta_content_scope: meta.control.repeat.s840d_gcode
            - include: iso-repeat-count
            - include: expressions-line
        - include: line-end-or-illegal

  stmt-repeat-body:
    - meta_content_scope: meta.section.repeat.s840d_gcode
    - match: (?i:UNTIL)\b
      scope: keyword.control.until.s840d_gcode
      set:
        - meta_scope: meta.control.until.s840d_gcode
        - meta_content_scope: meta.section.repeat.s840d_gcode
        - include: expressions-line
    - include: main-sublevel

###############################################################################
# RET / RETB
# TESTS: syntax_test_ret.spf
###############################################################################

  stmt-ret:
    - match: (?i:RETB?)\b
      scope: meta.function-call.name.s840d_gcode keyword.control.ret.s840d_gcode
      set: cycle-call-arguments

###############################################################################
# STOPRE
# TESTS:
###############################################################################

  stmt-stopre:
    - match: (?i:STOPRE)\b
      scope: keyword.control.stopre.s840d_gcode
      set: assert-line-end

###############################################################################
# SYNCHRONE ACTION
# TESTS: syntax_test_synact.spf
###############################################################################

  # modal identifier
  stmt-synact:
    - match: (?i:ID[S]?)\b
      scope: keyword.control.synact.identifier.s840d_gcode
      set:
        - meta_scope: meta.synact.s840d_gcode
        - match: =(?=[\s\w])
          scope: keyword.operator.assignment.s840d_gcode
          set:
            - meta_content_scope: meta.synact.s840d_gcode
            - include: stmt-synact-condition
            - include: expressions-line
        - include: line-end-or-illegal
    - include: stmt-synact-condition

  # condition
  stmt-synact-condition:
    - match: (?i:EVERY|FROM|WHEN|WHENEVER)\b
      scope: keyword.control.synact.condition.s840d_gcode
      set:
        - meta_content_scope: meta.synact.s840d_gcode
        # assignments are illegal in this context
        - match: =(?!=)
          scope: invalid.illegal.s840d_gcode
        - include: stmt-synact-operation
        - include: expressions-line
    - include: stmt-synact-operation

  # operation
  stmt-synact-operation:
    - match: (?i:DO)\b
      scope: keyword.control.synact.operation.s840d_gcode
      set: [stmt-synact-operation-iso, stmt-synact-operation-cycle]
      with_prototype:
        # make sure to pop off before line end from all statements
        - match: $
          pop: true

  stmt-synact-operation-iso:
    - meta_content_scope: meta.synact.operation.s840d_gcode
    - include: stmt-iso-body

  stmt-synact-operation-cycle:
    - include: stmt-procedure-call
    - include: stmt-cycle-call
    - include: scope-end

###############################################################################
# WHILE ... ENDWHILE
# TESTS:
###############################################################################

  stmt-while:
    - match: (?i:WHILE)\b
      scope: keyword.control.while.s840d_gcode
      set:
        - meta_scope: meta.section.while.s840d_gcode
        - match: \n|(?=;)
          set: stmt-while-body
        - include: expressions
        - include: illegal

  stmt-while-body:
    - meta_content_scope: meta.section.while.s840d_gcode
    - match: (?i:ENDWHILE)\b
      scope: keyword.control.endwhile.s840d_gcode
      set: assert-line-end    # leave loop-body
    - include: main-sublevel

###############################################################################
# EXPRESSIONS
###############################################################################

  expressions-group:
    - match: \(
      scope: punctuation.section.group.begin.s840d_gcode
      push: [expressions-group-body, after-operator]

  expressions-group-body:
    - meta_scope: meta.group.s840d_gcode
    - match: \)
      scope: punctuation.section.group.end.s840d_gcode
      pop: true
    - include: expressions-line

  expressions-line:
    - include: expressions
    - include: line-end-or-illegal

  expressions:
    - include: expressions-group
    - include: placeholder
    - include: operators
    - include: constants
    - include: illegal-keywords
    - include: function-call
    - include: variables
    - include: comment-block

  comment-block:
    - match: \(
      scope: punctuation.definition.comment.begin.s840d_gcode
      push:
        - meta_scope: comment.block.s840d_gcode
        - match: \)
          scope: punctuation.definition.comment.end.s840d_gcode
          pop: true
        - include: ignore-parens

  comment-line:
    - match: ;
      scope: punctuation.definition.comment.begin.s840d_gcode
      set:
        - meta_scope: comment.line.s840d_gcode
        - match: \n
          pop: true

  comment-disabled:
    - match: /
      scope: punctuation.definition.comment.begin.s840d_gcode
      push:
        - meta_scope: comment.line.disabled.s840d_gcode
        - match: \n
          pop: true

  placeholder:
    # fields of auto-completion to be filled by user
    - match: '[<\[][\w\.]+[>\]]'
      scope: comment.block.placeholder.s840d_gcode

  constants:
    - include: numbers
    - include: booleans
    - include: strings
    - include: axis-constants

  booleans:
    # language constants
    - match: (?i:FALSE|TRUE)\b
      scope: constant.language.boolean.s840d_gcode

  numbers:
    # decimal numbers
    - match: '{{float}}(?:\.|\b)'
      scope: constant.numeric.s840d_gcode
    # single quoted binary numbers
    - match: '('')([Bb])'
      captures:
        1: punctuation.definition.numeric.begin.s840d_gcode
        2: punctuation.definition.numeric.binary.s840d_gcode
      push:
      - meta_scope: constant.numeric.binary.s840d_gcode
      - match: '''|$'
        scope: punctuation.definition.numeric.end.s840d_gcode
        pop: true
      - match: '[^01]'
        scope: invalid.illegal.s840d_gcode
    # single quoted hexadecimal numbers
    - match: '('')([Hh])'
      captures:
        1: punctuation.definition.numeric.begin.s840d_gcode
        2: punctuation.definition.numeric.hexadecimal.s840d_gcode
      push:
      - meta_scope: constant.numeric.hexadecimal.s840d_gcode
      - match: '''|$'
        scope: punctuation.definition.numeric.end.s840d_gcode
        pop: true
      - match: \H
        scope: invalid.illegal.s840d_gcode

  strings:
    - match: '"'
      scope: punctuation.definition.string.begin.s840d_gcode
      push:
        # double quoted strings with embedded highlighting
        - meta_scope: string.quoted.double.s840d_gcode
        # embedded double quotes
        - match: \'"\'
          scope: constant.character.escape.quoted.double.s840d_gcode
        # embedded line feed
        - match: '%[Nn]'
          scope: constant.other.linefeed.s840d_gcode
        # embedded sprint format parameter
        - match: '%\d*\.*\d*[DdFfSsXx]?\b'
          scope: constant.other.placeholder.s840d_gcode
        # valid end of double quoted string
        - match: '"'
          scope: punctuation.definition.string.end.s840d_gcode
          pop: true
        # invalid end of double quoted string
        - match: '[^"]$'
          scope: invalid.illegal.s840d_gcode
          pop: true

  axis-constants:
    - match: (?i:NO_AXIS)\b
      scope: constant.language.axis.s840d_gcode

###############################################################################
# SINUMERIK parameter constants
#     valid in arrays or function parameter blocks
#     e.g.:  $P_UIFR[X,0,TR]
#            CTRANS(0.40,X,TR)
###############################################################################

  frame-constants:
    - match: (?i:TR|FI|RT|SC|MI)\b
      scope: constant.language.frameindex.s840d_gcode

###############################################################################
# SINUMERIK orientation polynom constants
#     valid in arrays
#     e.g.:  PO[THT]=...
###############################################################################

  trafo-constants:
    - match: (?i:P[HS]I|THT|[XYZ]H)\b
      scope: constant.language.orientation.s840d_gcode

###############################################################################
# SINUMERIK operators
###############################################################################

  operators:
    - include: operators-arithmetic
    - include: operators-assignment
    - include: operators-logical

  operators-arithmetic:
    # aritmetic operators
    - match: '[-+/\*]'
      scope: keyword.operator.arithmetic.s840d_gcode
    - match: (?i:MOD|DIV)\b
      scope: keyword.operator.arithmetic.s840d_gcode
    # special SINUMERIK arithmetic operator
    # found in CST cycles
    - match: (?i:_DEC[1-9])\b
      scope: keyword.operator.arithmetic.s840d_gcode

  operators-assignment:
    # assignment
    - match: =(?!=)
      scope: keyword.operator.assignment.s840d_gcode
      push: after-assignment
    # string and frame chaining
    - match: '<<|:'
      scope: keyword.operator.assignment.s840d_gcode
      push: after-operator

  operators-logical:
    # relational operators
    - match: '[=<>]=|<>|[<>](?!<)'
      scope: keyword.operator.logical.s840d_gcode
      push: after-operator
    - match: (?i:AND|OR|XOR|NOT)\b
      scope: keyword.operator.logical.s840d_gcode
    - match: (?i:B_AND|B_OR|B_XOR|B_NOT)\b
      scope: keyword.operator.bitwise.s840d_gcode

  after-assignment:
    # string chaining after assignment is allowed
    - match: <<
      scope: keyword.operator.assignment.s840d_gcode
      set: after-operator
    - include: after-operator

###############################################################################
# SINUMERIK storage modifiers
###############################################################################

  storage-modifier-scope:
    - match: (?i:NCK|CHAN)\b
      scope: meta.definition.scope.s840d_gcode storage.modifier.scope.s840d_gcode

  storage-modifier-access:
    - match: (?i:AP[RWX][BP]?)\b
      scope: storage.modifier.access.s840d_gcode
      push:
        - meta_scope: meta.definition.access.s840d_gcode
        # allowed access levels are 0..7
        - match: \b[0-7]\b
          scope: constant.numeric.integer.s840d_gcode
          pop: true
        # macro defined value
        - match: '{{macro}}'
          scope: variable.other.s840d_gcode
          pop: true
        - include: illegal-pop
    # data class S828D
    - match: (?i:DC[IMU])\b
      scope: meta.definition.access.s840d_gcode storage.modifier.access.s840d_gcode

  storage-modifier-init:
    - match: (?i:INI(?:CF|RE|PO)|PRLOC)\b
      scope: meta.definition.init.s840d_gcode storage.modifier.init.s840d_gcode

  storage-modifier-limits:
    - match: (?i:LL[IU])\b
      scope: storage.modifier.limit.s840d_gcode
      push:
        - meta_scope: meta.definition.limit.s840d_gcode
        # decimal numbers allowed here
        - match: '[-+]?{{float}}'
          scope: constant.numeric.float.s840d_gcode
          pop: true
        # macro defined value
        - match: '{{macro}}'
          scope: variable.other.s840d_gcode
          pop: true
        - include: illegal-pop

  storage-modifier-sync:
    - match: (?i:SYN(?:[RW]|RW))\b
      scope: meta.definition.sync.s840d_gcode storage.modifier.sync.s840d_gcode

  storage-modifier-unit:
    - match: (?i:PHU)\b
      scope: storage.modifier.unit.s840d_gcode
      push:
        - meta_scope: meta.definition.unit.s840d_gcode
        # allowed units are 0...156
        - match: \b(?:1(?:[0-4][0-9]|5[0-6])|\d{1,2})\b
          scope: constant.numeric.integer.s840d_gcode
          pop: true
        # macro defined value
        - match: '{{macro}}'
          scope: variable.other.s840d_gcode
          pop: true
        - include: illegal-pop

###############################################################################
# SINUMERIK storage types
###############################################################################

  storage-modifiers:
  - match: (?i:VAR\b)
    scope: storage.modifier.var.s840d_gcode

  storage-types:
    - match: (?i:AXIS|BOOL|FRAME|INT|REAL|CHAR)\b
      scope: storage.type.s840d_gcode

    - match: (?i:STRING)\b
      scope: storage.type.string.s840d_gcode
      push:
        - match: \[
          scope: punctuation.definition.string-size.begin.s840d_gcode
          set:
            - meta_scope: storage.type.string.s840d_gcode
            - meta_content_scope: meta.string-size.s840d_gcode
            - match: \]
              scope: punctuation.definition.string-size.end.s840d_gcode
              pop: true
            - match: \d+\b
              scope: constant.numeric.integer.s840d_gcode
            - match: '{{macro}}'
              scope: variable.other.s840d_gcode
        - include: scope-end

###############################################################################
# FUNCTION CALL
###############################################################################

  function-call:
    - include: nc-function-call
    - include: generic-function-call

  nc-function-call:
    # known NC functions
    - match: (?:A(?:BS|C|C(?:[NP]|OS)|DDFRAME|SIN|TAN2|X(?:NAME|STRING|TOSPI))|B(?:OUND|TO[IR])|C(?:A(?:C|C[NP]|LC(?:DAT|POSI))|DC|FINE|HKD(?:M|NO)|IC|MIRROR|O(?:LLPAIR|S)|R(?:O(?:T|TS)|PL)|SCALE|T(?:A(?:B|B(?:EXISTS|F(?:NO|POL|SEG)|I(?:D|NV|SLOCK)|M(?:EMTYP|POL|SEG)|N(?:O|OMEM)|P(?:ERIOD|O(?:L|LID))|S(?:E(?:[GV]|GID)|SV)|T(?:E[PV]|M(?:AX|IN)|S[PV])))|RANS))|D(?:AC|C|EL(?:DL|ML(?:OWNER|RES)|OBJ|TOOLENV)|IC)|EXP|G(?:ET(?:ACT(?:T|TD)|DNO|T|T(?:COR|ENV)|VAR(?:AP|DFT|LIM|PHU|TYP))|P)|I(?:C|N(?:DEX|TERSEC|VFRAME)|S(?:AXIS|FILE|NUMBER|VAR)|TO[BR])|L(?:ENTOAX|N)|M(?:A(?:TCH|XVAL)|EA(?:FRAME|SURE)|IN(?:DEX|VAL)|ODAXVAL)|N(?:AMETOINT|EW(?:MT|T)|UMBER)|P(?:[MR]|O(?:SRANGE|T)|ROTD)|QU|R(?:AC|EP|I(?:C|NDEX)|OUN(?:D|DUP)|TO[BI])|S(?:E(?:T|T(?:DNO|TCOR))|I(?:N|RELAY)|P(?:I|RINT)|QRT|TR(?:INGIS|LEN)|UBSTR)|T(?:AN|O(?:LOWER|OL(?:ENV|G(?:NT|T))|UPPER)|RUNC))\b
      scope: support.function.nck.s840d_gcode
      push: function-call-arguments

  generic-function-call:
    # unknown function is handled as subprogram (SPF)
    - match: '{{macro}}(?=[ \t]*\()'
      scope: variable.function.other.s840d_gcode
      push: function-call-arguments

  function-call-arguments:
    - meta_scope: meta.function-call.name.s840d_gcode
    - match: (?=\()
      set: [function-call-arguments-body, after-operator, function-call-arguments-begin]
    - include: scope-end

  function-call-arguments-begin:
    - match: \(
      scope: punctuation.section.arguments.begin.s840d_gcode
      pop: true
    - include: scope-end

  function-call-arguments-body:
    - meta_scope: meta.function-call.arguments.s840d_gcode
    - match: \)
      scope: punctuation.section.arguments.end.s840d_gcode
      set: illegal-brackets-pop
    - include: seperator-comma-minus
    - include: frame-constants
    - include: expressions-line

###############################################################################
# known variables
###############################################################################

  variables:
    - include: nc-variables
    - include: axis-variables
    - include: global-variables
    - match: '{{ident}}'
      scope: variable.other.s840d_gcode
      push: array-index

  after-variable:
    - include: illegal-square
    - include: scope-end

  axis-variables:
    - match: '{{axis}}\d*\b'
      scope: support.variable.axis.s840d_gcode
      push: array-index
    - match: S\d*\b
      scope: support.variable.spindle.s840d_gcode
      push: array-index

  global-variables:
    # SINUMERIK R-Parameter
    - match: '[Rr][Gg]?\d+(?!\.)'
      scope: support.variable.nck.r.s840d_gcode
      push: after-variable

    # SINUMERIK R-Parameter
    - match: '[Rr][Gg]?(?=[ \t]*\[)'
      scope: support.variable.nck.r.s840d_gcode
      push: array-index

    # SINUMERIK synchron action guds
    - match: (?:SYG_[ABCIRS][4-9MUS])\b
      scope: support.variable.nck.guds.s840d_gcode
      push: array-index

  nc-variables:
    - match: \$
      scope: support.variable.nck.s840d_gcode punctuation.definition.variable.nck.s840d_gcode
      push:
        # SINUMERIK PI constant
        - match: (?:PI)\b
          scope: support.variable.nck.pi.s840d_gcode
          set: after-variable

        # SINUMERIK synchron action R-Parameters
        - match: '[Rr][Gg]?\d+\b'
          scope: support.variable.nck.r.s840d_gcode
          set: after-variable

        # SINUMERIK R-Parameter
        - match: '[Rr][Gg]?(?=[ \t]*\[)'
          scope: support.variable.nck.r.s840d_gcode
          set: array-index

        # SINUMERIK synchron action vars
        - match: \$?(?:SYG_[ABCIRS][4-9MUS])\b
          scope: support.variable.nck.guds.s840d_gcode
          set: array-index

        # SINUMERIK nc variables
        - match: \$?(?:A(?:_(?:CMDSI|D(?:AY|B(?:[BDRW]|S[BW])|L[BDRW]|P(?:_(?:IN_(?:CONF|LENGTH|STATE|VALID)|OUT_(?:CONF|LENGTH|STATE|VALID))|B_(?:IN|OUT)|R_(?:IN|OUT)|S(?:B_(?:IN|OUT)|D_(?:IN|OUT)|W_(?:IN|OUT))|W_(?:IN|OUT)))|F(?:RDP_(?:ACK_REQ|DIAG|ERR(?:_REAC|OR)|S(?:ENDMODE|UB(?:S|S_ON)))|SDP_(?:DIAG|ERR(?:_REAC|OR)|SUBS_ON))|GG|HOUR|I(?:N|N(?:A|CO|S(?:[EI]|E(?:[DP]|PD)|I(?:[DP]|PD))))|L(?:EVELSID|INK_TRANS_RATE)|M(?:ARKERS(?:I|I(?:[DP]|PD))|INUTE|ON(?:IFACT|TH)|SECOND|YM(?:LN|N|T(?:LN|N)))|OU(?:T|T(?:A|S(?:[EI]|E(?:[DP]|PD)|I(?:[DP]|PD))))|P(?:B(?:B_(?:IN|OUT)|D_(?:IN|OUT)|R_(?:IN|OUT)|W_(?:IN|OUT))|LCSI(?:IN|OUT)|RO(?:B(?:E|E_LIMITED)|T(?:_LOCK|O|OC)))|S(?:ECOND|T(?:ATSID|OPESI))|T(?:IMERSI|OOLM(?:LN|N|T(?:LN|N)))|USED(?:[DT]|ND)|XFAULTSI|YEAR)|A_(?:A(?:C(?:C|C(?:_PERCENT|LIMA)|S_REL|T_INDEX_AX_POS_NO)|LARM_STAT|TOL|X(?:_DISABL(?:E|E_SRC)|CHANGE_(?:STAT|TYP)))|B(?:CS_OFFSET|RAKE_(?:COND[BM]|STATE))|C(?:HANNO|O(?:LLPOS|UP_(?:ACT|COR(?:R|R_DIST)|OFFS))|P(?:ACT(?:FA|LA)|BC|DEFLA|F(?:AC(?:CT|T)|CMD(?:PT|VT)|M(?:O[FN]|SON)|R(?:EQV|S))|L(?:ACC|C(?:MD[PV]|TID)|DEN|IN(?:SC|TR)|NUM|OUT(?:SC|TR)|S(?:ETVAL|TATE)|TYPE)|M(?:ALARM|RESET|STAR(?:T|TPRT)|VDI)|N(?:ACT(?:FA|LA)|DEFLA)|S(?:ETTYPE|YN(?:CO(?:[PV]|P2)|FI(?:[PV]|P2))))|URR)|D(?:E(?:LT|PAXO)|IAM_STAT|RF|T(?:B(?:[BW]|RE(?:[BM]|B_(?:C(?:MD|ORR)|DEP)|M_(?:C(?:MD|ORR)|DEP)))|E(?:[BW]|P[BW])|S[BW]))|E(?:G_(?:A(?:CTIVE|X)|DENOM|NUM(?:_LA|ERA)|SY(?:N|NFA)|TYPE)|NC(?:_(?:A(?:CTIVE|MPL)|COM(?:P|P_(?:IS_MODULO|M(?:AX|IN)|STEP)))|1_ACTIVE|2_ACTIVE)|SR_(?:ENABLE|STAT|TRIGGER)|TRANS)|F(?:GR(?:EF|OUP)|IX_POINT_SELECTED|OC|XS)|I(?:[BMW]|B(?:_CORR|[CN]|N_CORR)|E(?:N|N_CORR)|N(?:_SYNC|POS_STAT)|PO_NC_CHANAX|TR|W_CORR)|J(?:ERK(?:_(?:COUNT|T(?:IME|OT))|LIMA)|OG_POS_(?:ACT|SELECTED))|L(?:EAD_(?:[PV]|P_TURN|S[PV])|OA(?:D|D_SMOOTH))|M(?:A(?:CHAX|SL_(?:DEF|STAT))|EA(?:ACT|S_(?:P(?:1_VALID|2_VALID|3_VALID|4_VALID|OINT[1-4])|S(?:ET(?:ANGLE|POINT)|P_VALID)))|[MW]|M[1-4]|OTEND|W[1-4])|O(?:F(?:F|F_(?:LIMIT|VAL))|N_FIX_POINT|SCILL_(?:BREAK_POS[12]|REVERSE_POS[12])|VR)|P(?:CS_REL|LC_OVR|O(?:LF(?:A|A_VALID)|SRES|WE(?:R|R_SMOOTH))|ROG_INDEX_AX_POS_NO)|QE(?:C|C_(?:ACCEL_[1-3]|COARSE_STEPS|DIRECTIONAL|FINE_STEPS|LEARNING_RATE|MEAS_TIME_[1-3]|TIME_[12]))|RE(?:F|POS_DELAY)|S|S(?:C(?:C_STAT|PAR|TRACE)|NGLAX_STAT|OFTEND[NP]|TAT|YN(?:C|CDIF(?:F|F_STAT)))|T(?:O(?:F(?:F|F_(?:LIMIT|PREP_DIFF|VAL))|RQUE|TAL_OVR)|RAVEL_(?:COUN(?:T|T_HS)|DIS(?:T|T_HS)|TIM(?:E|E_HS))|Y(?:P|PE))|V(?:ACT[BMW]|C|ELOLIMA))|C_(?:A(?:CT(?:_(?:ORI_TOOL_LENGTH|PROG_NET_TIME|TOOL_LENGTH_INDEX)|UAL_PARTS)|LARM_STAT|SUP|U(?:TO_JOG_STATE|XFU_(?:EXT|M_(?:EXT|STATE|TICK|VALUE)|PREDEF_INDEX|S(?:PEC|TATE)|T(?:ICK|YPE)|VALUE))|XCTSWA)|BLOCK(?:_PROGINFO|TYP(?:E|EINFO))|C(?:O(?:LLPOS|N(?:E_ANGLE|STCUT_S))|TOL|UT(?:_INV|MO(?:D|D(?:_ANG|K|KA))|TING_TIME)|YCLE_TIME)|D(?:EL(?:AYFST|T)|RF|T(?:B[BW]|E[BW]))|ESR_TRIGGER|F|F(?:_(?:G0|TYPE)|CT(?:[0-3]|1(?:C|LL|UL)|2(?:C|LL|UL)|3(?:C|LL|UL)|LL|UL)|GROUP_MASK|IF(?:O|O(?:[1-9]|10))|Z)|G0MODE|I(?:N_KEY_(?:G|G_(?:ENABLE|ISENABLE|RUN_(?:IN|OUT)))|PO_(?:BU(?:F|FLA)|STATE)|W_(?:STAT|TU))|JOG_C(?:IRCLE_SELECTED|OORD)|LIFTFAST|M(?:_TOOL_LENGTH_INDEX|ARKER|E(?:A|AS_(?:ACT_PLANE|C(?:H(?:BFR|SFR)|ORNER_(?:ANGLE|SETANGLE))|D(?:_NUMBER|I(?:AMETER|R_APPROACH))|F(?:INE_TRANS|RAM(?:E|E_SELECT))|GFR|INPUT|LATCH|NCBFR|ORIWKS|P(?:1_COORD|2_COORD|3_COORD|4_COORD|FRAME)|RESULTS|S(?:CALEUNIT|E(?:MA|T_COORD))|T(?:_NUMBER|OOL_(?:LENGTH|MASK)|YPE)|UIFR|VALID|WP_(?:ANGLE|SETANGLE)))|ONMIN|SNUM|THNUM)|O(?:FF_(?:LEAD|[OR]|O(?:_(?:ANGLE|DIR)|RI_LIMIT)|R_(?:ANGLE|DIR)|T(?:HETA|ILT))|LD_PROG_NET_TIM(?:E|E_COUNT)|PERATING_TIME|TOL|VR)|P(?:A(?:RAM|TH(?:ACC|JERK|N))|L(?:C_OVR|T(?:BB|EB))|R(?:E(?:P_(?:ACT_LOA(?:D|D_GROSS)|M(?:AX_LOA(?:D|D_GROSS)|IN_LOA(?:D|D_GROSS)))|SET)|O(?:G|G_NET_TIME_TRIGGER)|TIME_(?:[ABM]|A_INC|M_INC)))|R(?:E(?:POS_PATH_MODE|QUIRED_PARTS|TPOINT)|OT_SYS|PVALID)|S(?:_TYPE|AFE_SYNA_MEM|DIR|ERUPRO|GEAR|IM_(?:MODE|TIME_(?:BLOCK|STEP))|M(?:AX(?:AC(?:C|C_INFO)|VEL(?:O|O_INFO))|INVEL(?:O|O_INFO)|ODE)|P(?:ECIAL_PARTS|IND_STATE|LITBLOCK)|T(?:AT|O(?:LF|P_COND))|VC|Y(?:N(?:A_(?:MEM|STATE)|C_(?:A(?:CT_LOAD|VERAGE_LOAD)|MAX_LOAD))|STEM_(?:MARKER|PARAM)))|T(?:_TOOL_LENGTH_INDEX|ANEB|C|C_(?:ACK[CT]|CMD[CT]|FCT|L(?:F[NO]|MYN|T[NO])|M(?:F[NO]|MYN|T(?:DIST|LTN|[NO]|NLOC|TN))|STATUS|T(?:HNO|NO|OOLIS))|HREAD_PITC(?:H|H_(?:ACT|INC))|IM(?:E|E(?:[CRS]|SC))|O(?:F(?:F|F[LR])|OL(?:_(?:O_(?:ACT|COR(?:R|RD)|DIFF|END)|R_(?:ACT|COR(?:R|RD)|DIFF|END))|O_(?:ACT|DIFF|END)|R_(?:ACT|DIFF|END))|TAL_(?:OVR|PARTS))|RA(?:F(?:O|O_(?:C(?:HAIN|ORR_ELEM_[PT])|NAME|ORIAX_(?:DIR_[PT]|LOC)|PA(?:R|RSET)|SECTION_[PT]|TYPE_NAME))|NS_SYS))|V(?:ACT(?:[BW]|BF|WF)|C)|WORKAREA_CS_(?:COORD_SYSTEM|GROUP|LIMIT_(?:MINUS|PLUS)|MINUS_ENABLE|PLUS_ENABLE))|N_(?:A(?:CTIVATE_COLL_CHECK|UXFU_LIST_(?:CHANNO|ENDINDEX|GROUPINDEX)|XCT(?:AS|SW[AE]))|BUS_FAIL_TRIGGER|C(?:E(?:C|C_(?:DIRECTION|I(?:NPUT_(?:AXIS|NCU)|S_MODULO)|M(?:AX|IN|ULT_BY_TABLE)|OUTPUT_(?:AXIS|NCU)|STEP|TYPE))|OLL_(?:CHECK_OFF|IPO_(?:ACTIVE|LIMIT)|LOAD|MEM_(?:AVAILABLE|USE_(?:ACT|M(?:AX|IN)))|PAIRS_ACT|STAT(?:E|E_COND)))|E(?:SR_TRIGGER|XPORT_RESTRICTED)|FACETS_(?:A(?:CT|VAILABLE)|INTERN_(?:A(?:CT|VAILABLE)|M(?:AX|IN))|M(?:AX|IN))|IPO_(?:ACT_LOAD|CHANAX|LOAD_(?:LIMIT|PERCENT)|M(?:AX_LOAD|IN_LOAD))|KIN_CHAIN_ELEM_ACT|L(?:A(?:I_AX_(?:IS_(?:AXCTAX|L(?:EADLINKAX|INKAX))|TO_(?:IPO_NC_CHANAX|MACHAX))|NGUAGE_ON_HMI)|INK_(?:CO(?:MM_STATE|NN_(?:RCV|S(?:IZE_LINKVAR|ND)))|TRANS_RATE_LAS(?:T|T_SUM)))|NCK_VERSION|P(?:ERSDIAG|OWERON_(?:STATE|TIME)|R(?:EP_(?:ACT_LOA(?:D|D_GROSS)|M(?:AX_LOA(?:D|D_GROSS)|IN_LOA(?:D|D_GROSS)))|OT_AREA(?:_ELEM_ACT|S_ACT)))|R(?:EBOOT_DELAY_TIME|OB(?:IN|OUT))|S(?:E(?:RVO_(?:ACT_LOAD|M(?:AX_LOAD|IN_LOAD))|TUP_TIME)|IM_(?:CHAN_MASK|MAX_IPOSTEP)|LTRACE|YNC_(?:ACT_LOAD|MAX_LOAD|TO_IPO))|T(?:_PROT_ELEM_ACT|IMER)|VMODEL_STATUS))|C_(?:[ABCDEFGHIJKLMNOPQRSTUVWXYZ]|A(?:_PROG|LL_PROG|UX_(?:EXT|IS_QUICK|VALUE))|B_PROG|C_PROG|D(?:_PROG|L|L_PROG|UPL(?:O|O_PROG))|E_PROG|F_PROG|G(?:_PROG|60_PROG)|H(?:_PROG|E|E_PROG)|I(?:_(?:NUM|ORDER|PROG)|N|NC_PROG|SOPRINT)|J_(?:NUM|ORDER|PROG)|K_(?:NUM|ORDER|PROG)|L_PROG|M(?:_PROG|ACPAR|E|E_PROG|T(?:L|L_PROG))|N_PROG|O(?:_PROG|UT)|P(?:_PROG|I|I_PROG)|Q_PROG|R_PROG|S_PROG|T(?:_(?:PROG|VALUE)|CA|[ES]|E_PROG|HN(?:O|O_PROG)|S_PROG|YP_PROG)|U_PROG|V_PROG|W_PROG|X_PROG|Y_PROG|Z_PROG)|EPS_[ABCIRS]|N(?:K_(?:A(?:_OFF|XIS)|N(?:AME|EXT)|OFF_DIR|PARALLEL|SWITC(?:H|H_(?:INDEX|POS))|TYPE)|P_(?:1ST_PROT|A(?:DD|NG)|BIT_NO|C(?:HAIN_ELEM|OL(?:L_PAIR|OR))|D(?:_LEVEL|IR)|FILENAME|IN(?:DEX|IT_STAT)|N(?:AME|EX(?:T|TP))|OFF|P(?:ARA|ROT_(?:COLOR|D_LEVEL|NAME|TYPE))|SAFETY_DIST|T(?:_(?:ANG|DIR|FILENAME|NAME|OFF|PARA|TYPE)|YPE)|USAGE)|T_(?:AUX_POS|BASE_ORIEN(?:T|T_NORMAL)|C(?:LOSE_CHAIN_[PT]|NTRL|ORR_ELEM_[PT])|GEO_AX_NAME|HIRTH_(?:INC|OFF)|I(?:DENT|GNORE_TOOL_ORIENT)|NAME|OEM_PAR_[DIS]|P(?:_CHAIN_LAST_ELEM|OLE_(?:LIMIT|SIDE_FIX|TOL))|ROT_(?:AX_(?:CNT|M(?:AX|IN)|NAME|POS)|OFFSET_FROM_FRAME)|T(?:_(?:CHAIN_LAST_ELEM|REF_ELEM)|RA(?:CON_CHAIN|FO_(?:IN(?:CLUDES_TOOL|DEX)|TYPE)))))|P(?:_(?:A(?:C(?:CESSLEVEL|SFRAME|T(?:_TOOL_LENGTH_INDEX|BFRAME|FRAME|GEOAX|ID))|[DP]|DT|EP|P(?:DV|R)|T(?:D|DT|PG)|XN[1-3])|B(?:FRAME|LOCKNO)|C(?:H(?:ANNO|BF(?:R|R(?:(?:[0-9]|1[0-5])|AM(?:E|E(?:[0-9]|1[0-5]))|MASK))|SFRMASK)|O(?:NSTCUT_S|UP_OFFS)|T(?:ABDEF|OL)|UT(?:_INV|MO(?:D|D(?:_(?:ANG|ERR)|K|KA)))|YCF(?:R|RAME))|[DFHS]|D(?:_BEFORE_SEARCH|ELAYFST|IAM_STAT|L(?:_BEFORE_SEARCH|NO)|RYRUN)|E(?:G_BC|P|PM|XT(?:BUF|F(?:R|RAME)|GG|PATH))|F(?:_TYPE|[AZ]|GROUP_MASK|IX_STAT)|G(?:F(?:R|R(?:AME|NUM))|G|WPS)|I(?:FRAME|NCOAP_(?:[BCIR]|S(?:16|160|32|IZE))|PTRLOCK|S(?:_EES_PATH|O(?:_STACK|1F(?:R|RAME)|2(?:_(?:DNO|HNO)|F(?:R|RAME))|3(?:_DNO|F(?:R|RAME))|4F(?:R|RAME))|TEST))|LI(?:FTFAST|NENO)|M(?:_TOOL_LENGTH_INDEX|A(?:G|G(?:[ANS]|DIS[LS]|HLT|N(?:[AHS]|DIS|HLT|REL)|REL))|C|MCA|ODEL_SCALING_OVL|SNUM|T(?:H(?:NU(?:M|M_BEFORE_SEARCH)|SDC)|OOL(?:MT|[NT]|NT)))|N(?:CBF(?:R|R(?:(?:[0-9]|1[0-5])|AM(?:E|E(?:[0-9]|1[0-5]))|MASK))|UM_SPINDLES)|O(?:FF(?:_(?:LEAD|[OR]|O_(?:ANGLE|DIR)|R_(?:ANGLE|DIR)|T(?:HETA|ILT))|N)|PMODE|RI_(?:DIFF|POS|S(?:OL|TAT))|TOL)|P(?:A(?:RTF(?:R|RAME)|TH)|FRAME|OL(?:F|F_VALID)|RO(?:G|G(?:_(?:EVENT|NAME|SUFFIX)|PATH)))|RE(?:LF(?:R|RAME)|PINF)|S(?:_TYPE|AUTOGEAR|CC_STAT|DIR|E(?:ARC(?:H|H(?:_(?:MASL[CD]|S|S(?:DIR|GEAR|MODE|PO(?:S|SMODE)))|[12L]))|TF(?:R|RAME))|GEAR|I(?:M|M(?:_MODE|UL))|MODE|T(?:ACK|OLF)|UB(?:_(?:A(?:UTOGEAR|XFCT)|CA|GEAR|LA|M19|S(?:PO(?:S|S(?:A|IT|MODE))|TAT))|PAR)|VC)|T(?:_TOOL_LENGTH_INDEX|C|C(?:ANG|DIFF|NUM|S(?:OL|TAT))|ECCYCLE|H(?:_OF_D|READ_PITC(?:H|H_INC))|MNOIS|O(?:F(?:F|F[LR])|O(?:L|L(?:_[OR]|BIN|[DLOPRT]|E(?:N(?:V|VN)|XIST)|F(?:R|RAME)|N(?:[DGOT]|DL)|ROT)))|RAF(?:[OR]|O_(?:CHAIN|NUM|PA(?:R|RSET))|RAM(?:E|E_[PT])))|U(?:BFR|IF(?:R|RNUM)|SEKT)|VDITCP|W(?:ORKAREA_CS_(?:COORD_SYSTEM|LIMIT_(?:MINUS|PLUS)|MINUS_ENABLE|PLUS_ENABLE)|P(?:_STAT|F(?:R|RAME))))|A_(?:A(?:CCLIMA|TOL)|CP(?:ACT(?:FA|LA)|BC|DEFLA|F(?:ACT|M(?:O[FN]|SON)|POSSTAT|RS)|L(?:CTID|DEN|IN(?:SC|TR)|NUM|OUT(?:SC|TR)|S(?:ETVAL|TATE)|TYPE)|M(?:RESET|START)|N(?:ACT(?:FA|LA)|DEFLA)|S(?:ETTYPE|YN(?:CO[PV]|FI[PV])))|FGR(?:EF|OUP)|JERKLIMA|VELOLIMA)|C_(?:GCC_STATE|T(?:CARR_(?:AX_(?:OFFSET|VECT)|OFFSET)|RAFO_(?:NAME|ROT_CHA(?:IN_INDEX|N_AX_(?:EX|IN))|TYPE_NAME)))|I|N_(?:CHANGE_CNTR_N(?:K_(?:DATA|ELEM|SWITCH)|P_DATA|T_DATA)|ROB(?:IN|OUT)))|TC_(?:ADPT[123T]|CARR(?:_(?:CORR_ELEM|KIN_(?:CNTRL|PART_(?:END|START)|T(?:OOL_(?:END|START)|RAFO_NAME)))|(?:[1-9]|[1-6][0-9]))|DP(?:1|10|11|12|13|14|15|16|17|18|19|2|20|21|22|23|24|25|3|4|5|6|7|8|9|H|V|C(?:1|10|11|12|13|14|15|16|17|18|19|2|20|21|22|23|24|25|26|27|28|29|3|30|31|32|33|34|35|36|37|38|39|4|40|41|42|43|44|45|46|47|48|49|5|50|51|52|53|54|55|56|57|58|59|6|60|61|62|63|64|7|8|9|E|S(?:[1-9]|10))|NT|ROT|V(?:[3-5]|N[3-5]))|ECP[1-7]?[0-9]|ISO_(?:[DHQR]|DW|HW|L(?:[1-3]|1W|2W|3W)|RW)|M(?:A(?:MP[1-3]|P(?:(?:[1-9]|10)|C(?:(?:[1-9]|[1-6][0-9])|S(?:[1-9]|10))))|DP[12]|LSR|OP(?:(?:[1-9]|1[0-5])|C(?:(?:[1-9]|[1-6][0-9])|S(?:[1-9]|10)))|P(?:P(?:_SP|(?:[1-9]|[1-6][0-9])|C(?:(?:[1-9]|[1-6][0-9])|S(?:[1-9]|10)))|TH)|SLR|TP(?:_(?:KD|P(?:OS|ROTA))|[2345678N]|C(?:(?:[1-9]|[1-6][0-9])|S(?:[1-9]|10))|P(?:[2467AL]|C(?:(?:[1-9]|[1-6][0-9])|S(?:[1-9]|10)))))|SCP[1-7]?[0-9]|TP(?:_(?:MAX_(?:ACC|VELO)|PROTA)|(?:[1-9]|1[0-1])|C(?:(?:[1-9]|[1-6][0-9])|S(?:[1-9]|10))|G(?:_DRSP(?:ATH|ROG)|[1-9])))|V(?:A_(?:A(?:BSOLUTE_ENC_(?:DELTA_INIT|ERR_CNT|STATE|ZERO_MON_MAX)|X_FORCE)|C(?:C_COMP_VA(?:L|L_TOTAL)|EC_COMP_VAL|OUP_OFFS|PSYNC2|URR)|D(?:IST_TORQUE|P(?:_ACT_TEL|E))|E(?:G_SYNCDIF(?:F|F_S)|NC(?:_ZERO_MON_(?:AC(?:CESS_CNT|T)|ERR_CNT|INIT)|1_COMP_VAL|2_COMP_VAL))|F(?:OC|X(?:S|S_INFO))|I(?:[BMSW]|BC|M[12]|NERTIA_TOTAL|PO_NC_CHANAX|TR)|L(?:AG_ERROR|OAD)|MOT_(?:CLAMPING_STATE|SENSOR_(?:ANA|CONF|DIGI))|P(?:O(?:SCTRL_MODE|WER)|RESSURE_[AB])|S(?:AFE_TYPE|CE|TOPSI|YNCDIF(?:F|F_STAT))|T(?:EMP_COMP_VAL|ORQU(?:E|E_AT_LIMIT))|VA(?:CTM|LVELIFT)|XFAULTSI)|C_(?:SGEAR|TOOL(?:_(?:[OR]|O_DIFF|R_DIFF)|[OR]|O_(?:DIFF|STAT)|R_(?:DIFF|STAT)))))\b
          scope: support.variable.nck.s840d_gcode
          set: array-index

        # SINUMERIK machine data
        - match: \$?(?:M(?:A(?:_(?:A(?:A_OFF_MODE|BS_INC_RATIO|C(?:_FILTER_TIME|CEL_(?:REDUCTION_(?:FACTOR|SPEED_POINT|TYPE)|TYPE_DRIVE)|T_POS_ABS)|UTO_GET_TYPE|X(?:_(?:E(?:MERGENCY_STOP_TIME|SR_DELAY_TIME[12])|INERTIA|JERK_(?:DAMP|ENABLE|FREQ|MODE|TIME|VEL[01])|M(?:ASS|OTION_DIR)|VELO_LIMIT)|CONF_ASSIGN_MASTER_(?:CHAN|NCU)|IS_(?:DIAGNOSIS|LANG_SUB_MASK|NUMBER_FOR_MONITORING)|SPDCTRL_ACT_POS_TOL))|B(?:A(?:CKLAS(?:H|H_(?:ACT_COMP|DY(?:N|N_MAX_VELO)|FACTOR|MODE))|SE_FUNCTION_MASK)|ERO_(?:CYCLE|DELAY_TIME_(?:MINUS|PLUS)|EDGE_TOL)|RAKE_MODE_CHOICE)|C(?:EC_(?:ENABLE|MAX_(?:SUM|VELO)|SCALING_SYSTEM_METRIC)|LAMP_POS_TO(?:L|L_TIME)|O(?:MP(?:_ADD_VELO_FACTOR|RESS_POS_TOL)|NTOUR_TOL|RR_VELO|UP(?:_SYNC_DELAY_TIME|LE_(?:POS_TOL_(?:COARS(?:E|E_2)|FIN(?:E|E_2))|VELO_TOL_(?:COARSE|FINE))))|TRLOUT_(?:LIMI(?:T|T_TIME)|MODULE_NR|NR|SEGMENT_NR|TYPE))|D(?:ES(?:_VELO_LIMIT|VAL_DELAY_(?:ENABLE|TIME))|ISPLAY_IS_MODULO|RI(?:FT_(?:ENABLE|LIMIT|VALUE)|LL_VELO_LIMIT|VE_(?:AX_RATIO(?:_(?:DENOM|NUMERA)|2_(?:DENOM|NUMERA))|ENC_RATIO_(?:DENOM|NUMERA)|SIGNAL_TRACKING))|YN_(?:LIMIT_RESET_MASK|MATCH_(?:ENABLE|TIME)))|E(?:G_(?:ACC_TOL|VEL_WARNING)|NC_(?:A(?:BS_(?:BUFFERING|TURNS_MODULO|ZEROMON_(?:INITIAL|WARNING))|CTVAL_SMOOTH_TIME)|C(?:HANGE_TOL|OMP_ENABLE)|DIFF_TOL|F(?:EEDBACK_POL|REQ_LIMI(?:T|T_LOW))|GRID_POINT_DIST|I(?:N(?:PUT_NR|VERS)|S_(?:DIREC(?:T|T2)|INDEPENDENT|LINEAR))|M(?:ARKER_INC|EAS_TYPE|ODULE_NR)|P(?:ASSIVE_PARKING|ULSE_MULT)|RE(?:FP_(?:M(?:ARKER_DIST|ODE)|STATE)|SOL)|S(?:E(?:GMENT_NR|RIAL_NUMBER)|SI_(?:MESSAGE_(?:FORMAT|LENGTH)|STATUS))|TYPE|ZERO(?:_MONITORING|MON_SYSVAR_CTRL))|PS_TLIFT_TANG_STEP|QUIV_(?:C(?:PREC_TIME|URRCTRL_TIME)|SPEEDCTRL_TIME)|SR_REACTION|VERY_ENC_SERIAL_NUMBER)|F(?:FW_(?:ACTIVATION_MODE|MODE)|I(?:PO_TYPE|X(?:_POINT_POS|ED_STOP_(?:A(?:CKN_MASK|LARM_(?:MASK|REACTION)|NA_TORQUE)|BY_SENSOR|CONTROL|MODE|T(?:HRESHOLD|ORQUE_(?:DEF|FACTOR|RAMP_TIME))|WINDOW_DEF)))|OC_(?:ACTIVATION_MODE|STANDSTILL_DELAY_TIME)|R(?:AME_OR_CORRPOS_NOTALLOWED|EQ_STEP_LIMIT|ICT_(?:ADAPT_(?:T(?:_STEP|ABLE_ACCEL)|V_(?:CONST_(?:MINUS|PLUS)|DECAY_(?:MINUS|PLUS)|STEP_(?:MINUS|PLUS)))|COMP_(?:A(?:CCEL[1-3]|DAPT_ENABLE)|CONST_M(?:AX|IN)|ENABLE|INC_FACTOR|MODE|TIME)|PRETRIGGER_TIME|T(?:_PULSE_(?:DELAY_TIME|SMOOTH_TIME)|ORQUE_STEP)|V(?:_PULSE_(?:CONST_TIME|DE(?:CAY_TIME|LAY_TIME)|SMOOTH_TIME)|ELO_STEP))))|G(?:00_(?:ACCEL_FACTOR|JERK_FACTOR)|A(?:IN_FOR_MONITORING|NTRY_(?:A(?:CT_POS_TOL_ERROR|XIS_TYPE)|BREAK_UP|FUNCTION_MASK|POS_TOL_(?:ERROR|REF|WARNING)))|EAR_STEP_(?:CHANGE_(?:ENABLE|POSITION)|M(?:AX_VEL(?:O|O(?:_LIMIT|2))|IN_VEL(?:O|O(?:_LIMIT|2)))|P(?:C_MAX_VELO_LIMIT|OSCTRL_ACCE(?:L|L2))|SPEEDCTRL_ACCEL|USED_IN_AXISMODE))|H(?:ANDWH_(?:MAX_INCR_(?:SIZE|VELO_SIZE)|STOP_COND|VELO_OVERLAY_FACTOR)|IRTH_IS_ACTIVE)|I(?:NDEX_AX_(?:ASSIGN_POS_TAB|DENOMINATOR|NUMERATOR|OFFSET)|S_(?:CONCURRENT_POS_AX|LOCAL_LINK_AXIS|ROT_AX|UNIPOLAR_OUTPUT|VIRTUAL_AX))|JOG_(?:AND_POS_(?:JERK_ENABLE|MAX_JERK)|INCR_WEIGH(?:T|T_TRAFO)|MAX_(?:ACCEL|JERK)|REV_VEL(?:O|O_RAPID)|VEL(?:O|O_RAPID))|L(?:EAD(?:_FUNCTION_MASK|SCREW_PITCH)|O(?:AD_SMOOTH_FILTER_TIME|OKAH_FREQUENCY)|UBRICATION_DIST)|M(?:A(?:INTENANCE_DATA|PPED_FRAME|X_(?:A(?:CCEL_OVL_FACTOR|X_(?:ACCEL|JER(?:K|K_FACTOR)|VELO))|JERK_STOP))|ISC_FUNCTION_MASK|M_(?:ENC_COMP_MAX_POINTS|QEC_MAX_POINTS)|ODULO_RANG(?:E|E_START)|S_(?:ASSIGN_MASTER_(?:SPEED_CMD|TORQUE_CTR)|COUPLING_ALWAYS_ACTIVE|FUNCTION_MASK|M(?:AX_CTRL_VELO|OTION_DIR_REVERSE)|SPIND_COUPLING_MODE|T(?:ENSION_TORQ(?:_FILTER_TIME|UE)|ORQUE_(?:CTRL_(?:ACTIVATION|I_TIME|MODE|P_GAIN)|WEIGHT_SLAVE))|VELO_TOL_(?:COARSE|FINE)))|NUM_(?:ENCS|FIX_POINT_POS|GEAR_STEP(?:S|S2))|O(?:EM_AXIS_INFO|FFSETVALUE_FOR_MONITORING)|P(?:A(?:RAMSET_CHANGE_ENABLE|TH_TRANS_(?:JERK_LIM|POS_TOL))|O(?:S(?:_(?:AX_VELO|LIMIT_(?:MINU(?:S|S2)|PLU(?:S|S2)))|CTRL_(?:CONFIG|D(?:AMPING|ESVAL_DELAY_INFO|UAL_FEEDBACK_TIME)|GAIN|INTEGR_(?:ENABLE|TIME)|OUT_FILTER_(?:ENABLE|TIME))|ITIONING_TIME)|WER_SMOOTH_FILTER_TIME)|ROFI(?:BUS_(?:ACTVAL_LEAD_TIME|CTRL_CONFIG|OUTVAL_DELAY_TIME|TORQUE_RED_RESOL)|SAFE_MODULE_NR))|R(?:ATED_(?:OUTVAL|VELO)|EFP_(?:BERO_LOW_ACTIVE|C(?:AM_(?:DIR_IS_MINUS|IS_ACTIVE|MARKER_DIST|SHIFT)|YCLE_NR)|M(?:AX_(?:CAM_DIST|MARKER_DIST)|OVE_DIS(?:T|T_CORR))|PERMITTED_IN_FOLLOWUP|S(?:E(?:ARCH_MARKER_REVERSE|T_POS)|TOP_AT_ABS_MARKER|YNC_ENCS)|VELO_(?:POS|SEARCH_(?:CAM|MARKER)))|OT_IS_MODULO)|S(?:AFE_(?:A(?:C(?:CEPTANCE_TST_TIMEOUT|KN|T_(?:CHECKSUM|STOP_OUTPUT))|DD_FUNCTION_MASK)|BRAKETEST_(?:CONTROL|POS_TOL|TORQU(?:E|E_NORM))|C(?:AM_(?:ENABLE|MINUS_OUTPUT|P(?:LUS_OUTPUT|OS_(?:MINUS|PLUS))|RANGE_(?:BIN_OUTPUT_[1-4]|OUTPUT_[1-4])|T(?:OL|RACK_(?:ASSIGN|OUTPUT)))|ONFIG_CHANGE_DATE|ROSSCHECK_CYCLE|TRLOUT_MODULE_NR)|D(?:ES_(?:CHECKSUM|VELO_LIMIT)|RIVE_PS_ADDRESS)|E(?:NC_(?:CONF|FREQ_LIMIT|G(?:EAR_(?:DENOM|NUMERA|PITCH)|RID_POINT_DIST)|I(?:DENT|NPUT_NR|S_(?:GEAR_REVERSAL|LINEAR))|M(?:EAS_STEPS_(?:POS1|RESOL)|OD(?:_TYPE|ULE_NR))|NUM_BITS|P(?:OLARITY|ULSE_SHIFT)|RESOL|SEGMENT_NR|TYPE)|XT_(?:PULSE_ENAB_OUTPUT|STOP_INPUT))|FUNCTION_ENABLE|GEAR_SELECT_INPUT|I(?:NFO_(?:EN(?:ABLE|C_RESOL)|MODULE_NR)|PO_STOP_GROUP|S_ROT_AX)|MOD(?:E_SWITCH_TIME|ULO_RANGE)|OVR_INPUT|P(?:ARK_ALARM_SUPPRESS|OS_(?:LIMIT_(?:MINUS|PLUS)|S(?:ELECT_INPUT|TOP_MODE)|TOL)|REV_CONFIG|ULSE_(?:DIS(?:_CHECK_TIME|ABLE_DELAY)|ENABLE_OUTPUT|STATUS_INPUT))|REFP_(?:POS_TOL|STATUS_OUTPUT)|S(?:INGLE_ENC|LIP_VELO_TOL|S_(?:DISABLE_INPUT|STATUS_OUTPUT)|T(?:ANDSTILL_(?:DELAY|POS|TOL|VELO_(?:LIMIT|TOL))|OP_(?:REQUEST_(?:EXT_INPUT|INPUT)|SWITCH_TIME_[CDEF]|VELO_TOL))|VSS_(?:DISABLE_INPUT|STATUS_OUTPUT))|VELO_(?:LIMIT|OVR_FACTOR|S(?:ELECT_INPUT|T(?:ATUS_OUTPUT|OP_(?:MODE|REACTION))|WITCH_DELAY)|X|X_(?:FILTER_TIME|HYSTERESIS|STATUS_OUTPUT)))|CALING_FACTOR_G70_G71|ERVO_DISABLE_DELAY_TIME|IMU_AX_VDI_OUTPUT|OFT_ACCEL_FACTOR|P(?:IND_(?:A(?:CTIVE_AFTER_RESET|SSIGN_TO_MACHAX)|DE(?:FAULT_(?:ACT_MASK|MODE)|S_VELO_TOL)|EXTERN_VELO_LIMIT|FUNC(?:_RESET_MODE|TION_MASK)|O(?:N_SPEED_AT_IPO_START|SCILL_(?:ACCEL|DES_VELO|START_DIR|TIME_C(?:CW|W)))|POS(?:CTRL_VELO|IT(?:_DELAY_TIME|IONING_DIR))|STOPPED_AT_IPO_START|VELO_LIMIT)|LINES_CONTROL_CONFIG)|T(?:ANDSTILL_(?:DELAY_TIME|POS_TOL|VELO_TOL)|EP_RESOL|IFFNESS_(?:CONTROL_(?:CONFIG|ENABLE)|DELAY_TIME)|OP_(?:LIMIT_(?:COARSE|F(?:ACTOR|INE))|ON_CLAMPING)))|T(?:ANG_OFFSET|EMP_COMP_TYPE|ORQUE_OFFSET|RACE_VDI_AX)|VELO_FFW_WEIGHT|W(?:AIT_ENC_VALID|ORKAREA_CHECK_TYPE))|S_(?:AXIS_MCS_POSITION|CLAMPING_TOLERANCE|S(?:IM_START_POSITION|PINDLE_(?:CHUCK_TYPE|PARAMETER))|TAILSTOCK_PARAMETER))|C(?:_(?:A(?:BSBLOCK_FUNCTION_MASK|CCEL_ORI|D(?:APT_PATH_DYNAMIC|D_MOVE_ACCEL_RESERVE)|LLOW_G0_IN_G96|U(?:TO_IPTR_LOCK|XFU_(?:ASS(?:IGN_(?:EXTENSION|GROUP|S(?:IM_TIME|PEC)|TYPE|VALUE)|OC_M(?:0_VALUE|1_VALUE))|D(?:_SYNC_TYPE|L_SYNC_TYPE)|F_SYNC_TYPE|H_(?:SYNC_TYPE|TYPE_INT)|M_SYNC_TYPE|PREDEF_(?:EXTENSION|GROUP|S(?:IM_TIME|PEC)|TYPE|VALUE)|QUICK_BLOCKCHANGE|S_SYNC_TYPE|T_SYNC_TYPE))|X(?:CONF_(?:CHANAX_(?:DEFAULT_NAME|NAME_TAB)|GEOAX_(?:ASSIGN_TAB|NAME_TAB)|MACHAX_USED)|ES_SCALE_ENABLE))|C(?:ART_JOG_SYSTEM|H(?:AN_NAME|BFRAME_(?:POWERON_MASK|RESET_MASK)|FRND_M(?:AXNUM_DUMMY_BLOCKS|ODE_MASK)|SFRAME_(?:POWERON_MASK|RESET_(?:CLEAR_MASK|MASK)))|IRCLE_ERROR_(?:CONST|FACTOR)|O(?:LLECT_TOOL_CHANGE|MPRESS(?:_(?:BLOCK_PATH_LIMIT|S(?:MOOTH_FACTO(?:R|R_2)|PLINE_DEGREE)|VELO_TOL)|OR_(?:MODE|PERFORMANCE))|N(?:ST_VELO_MIN_TIME|TOUR_(?:ASSIGN_FASTOUT|TUNNEL_(?:REACTION|TOL)))|UPL(?:E_(?:AXIS_1|BLOCK_CHANGE_CTRL_1|IS_WRITE_PROT_1|RESET_MODE_1)|ING_MODE_1))|PREC_WITH_FFW|TAB_(?:DEFAULT_MEMORY_TYPE|ENABLE_NO_LEADMOTION)|U(?:BIC_SPLINE_BLOCKS|RV_EFFECT_ON_PATH_(?:ACCEL|JERK)|T(?:COM_(?:C(?:ORNER_LIMIT|U(?:RVE_INSERT_LIMIT|SP_LIMIT))|INTERS_POLY_ENABLE|MAX(?:_DISC|NUM_(?:CHECK_BLOCKS|DUMMY_BLOCKS|SUPPR_BLOCKS))|P(?:ARALLEL_ORI_LIMIT|LANE_(?:ORI_LIMIT|PATH_LIMIT)))|MOD(?:_(?:ERR|INIT)|K_INIT)|TING_EDGE_(?:DEFAULT|RESET_VALUE))))|D(?:I(?:AMETER_AX_DEF|S(?:ABLE_PLC_START|PLAY_AXIS))|YN_ORI_OFF_(?:ANGLE|ON|VEL))|E(?:NABLE_START_MODE_MASK_PRT|SR_DELAY_TIME[12]|X(?:ACT_POS_MOD(?:E|E_G0_TO_G1)|TERN_(?:F(?:IXED_FEEDRATE_F1_ON|UNCTION_MASK)|G(?:0_LINEAR_MODE|CODE_(?:GROUPS_TO_PLC|RESET_(?:MODE|VALUES)))|PARALLEL_GEOAX|RIGID_TAPPING_M_NR)))|F(?:_VALUES_ACTIVE_AFTER_RESET|GROUP_(?:DEFAULT_AXES|PATH_(?:MODE|RATIO))|IFOCTRL_ADAPTION|RAME_(?:A(?:CS_SET|D(?:APT_MODE|D_COMPONENTS))|S(?:AA_MODE|UPPRESS_MODE)))|G(?:0_(?:LINEAR_MODE|TOLERANCE_FACTOR)|CODE_(?:GROUPS_TO_PL(?:C|C_MODE)|RESET_(?:MODE|S_(?:MODE|VALUES)|VALUES))|EOAX_CHANGE_(?:M_CODE|RESET))|HANDWH_(?:CHAN_STOP_COND|GEOAX_MAX_INCR_(?:SIZE|VSIZE)|ORIAX_MAX_INCR_(?:SIZE|VSIZE))|I(?:GN(?:_PROG_STATE_ASUP|ORE_(?:INHIBIT_ASUP|NONCSTART_ASUP|OVL_FACTOR_FOR_ADIS|REFP_LOCK_ASUP|SINGLEBLOCK_ASUP))|NVOLUTE_(?:AUTO_ANGLE_LIMIT|RADIUS_DELTA))|JOG_(?:ACCEL_GEO|JERK_(?:GEO|OR(?:I|I_ENABLE))|VELO_(?:GEO|ORI|RAPID_(?:GEO|ORI)))|L(?:EN_AC_FIFO|I(?:FTFAST_(?:DIST|MODE_MASK|STOP_COND|WITH_MIRROR)|MIT_CHECK_MODE)|OOKAH_(?:F(?:FORM|UNCTION_MASK)|NUM_OVR_POINTS|OVR_POINTS|RELIEVE_BLOCK_CYCLE|S(?:MOOTH_(?:FACTOR|WITH_FEED)|YSTEM_PARAM)|USE_VELO_NEXT_BLOCK))|M(?:AX(?:_(?:LEAD_ANGLE|PATH_JERK|TILT_ANGLE)|NUM_SYNC_DIAG_VAR)|M(?:_(?:A(?:BSBLOC(?:K|K_BUFFER_CONF)|RCLENGTH_SEGMENTS)|BUFFERED_AC_(?:MARKER|PARAM)|EES_TASK_STACK_SIZE|FEED_PROFILE_SEGMENTS|I(?:NT_TASK_STACK_SIZE|PO_BUFFER_SIZE)|L(?:INK_TOA_UNIT|OOKAH_(?:FFORM_UNITS|NUM_AC_TEST)|UD_VALUES_MEM)|MAX(?:_(?:AXISPOLY_PER_BLOCK|TRACE_DATAPOINTS)|NUM_SURF_GROUPS)|NUM_(?:AC_(?:MARKER|PARAM|SYSTEM_(?:MARKER|PARAM)|TIMER)|B(?:ASE_FRAMES|LOCKS_IN_PREP)|CC_(?:BLOCK_(?:ELEMENTS|USER_MEM)|HEAP_MEM)|FCTDEF_ELEMENTS|G_FRAMES|L(?:INKVAR_ELEMENTS|UD_NAMES_TOTAL)|PROTECT_AREA_(?:ACTIVE|C(?:HAN|ONTOUR))|R(?:_PARAM|EORG_LUD_MODULES)|S(?:AFE_SYNC_ELEMENTS|INGULARITY_BLOCKS|URF_LEVELS|YNC_(?:DIAG_ELEMENTS|ELEMENTS|STRINGS))|USER_FRAMES|VDIVAR_ELEMENTS|WORKAREA_CS_GROUPS)|ORI(?:PATH_CONFIG|SON_BLOCKS)|P(?:ATH_VELO_SEGMENTS|R(?:EP(?:_TASK_STACK_SIZE|DYN_BLOCKS)|OTOC_(?:NUM_ETP_(?:OEM_TYP|STD_TYP)|USER_ACTIVE)))|REORG_LOG_FILE_MEM|S(?:EARCH_RUN_RESTORE_MODE|HAPED_TOOLS_ENABLE|YSTEM_(?:DATAFRAME_MASK|FRAME_MASK))|T(?:OOL_DATA_CHG_BUFF_SIZE|RACE_DATA_FUNCTION))|C_INFO_(?:CUT_SPEE(?:D|D_STATUS)|NO_UNI(?:T|T_STATUS)|POSN_LI(?:N|N_STATUS)|REV_FEE(?:D|D_STATUS)|VELO_LI(?:N|N_STATUS)))|ODE(?:_AC_FIFO|SWITCH_MASK)|ULT(?:FEED_(?:ASSIGN_FASTIN|STORE_MASK)|ITOOLLOC_DEFAULT))|N(?:IBBLE_(?:P(?:RE_START_TIME|UNCH_(?:CODE|INMASK|OUTMASK))|SIGNAL_CHECK)|UM_AC_FIFO)|O(?:EM_CHAN_INFO|FF_ORI_MODE|NLINE_CUTCOM_ENABLE|RI(?:_(?:ANGLE_WITH_G_CODE|D(?:EF_WITH_G_CODE|ISP_(?:IS_MODULO|MODULO_RANG(?:E|E_START)))|IPO_WITH_G_CODE|TRAFO_ONLINE_CHECK_LI(?:M|MR))|AX_TURN_TAB_[12]|ENTATION_IS_EULER|PATH_MODE|S(?:MOOTHING_MODE|ON_(?:BLOCK_PATH_LIMIT|MODE|STEP_LENGTH))))|P(?:A(?:RT_COUNTE(?:R|R_MCODE)|TH_(?:IPO_IS_ON_TCP|MODE_MASK))|FRAME_RESET_MODE|OLE_ORI_MODE|R(?:E(?:PDYN_(?:MAX_FILT_LENGTH_(?:GEO|RD)|SMOOTHING_(?:FACTOR|ON))|VENT_SYNACT_LOCK_CHAN)|O(?:CESSTIMER_MODE|G_(?:EVENT_(?:IGN_(?:INHIBIT|PROG_STATE|REFP_LOCK|S(?:INGLEBLOCK|TOP))|MAS(?:K|K_PROPERTIES))|NET_TIMER_MODE)))|UNCH(?:_PA(?:RTITION_TYPE|TH_SPLITTING)|NIB_A(?:CTIVATION|SSIGN_FAST(?:IN|OUT)|XIS_MASK)))|R(?:E(?:FP_NC_START_LOCK|ORG_LOG_LIMIT|SET_MODE_MASK)|OT_AX_SWL_CHECK_MODE)|S(?:_VALUES_ACTIVE_AFTER_RESET|E(?:RUPRO_SPEED_(?:FACTOR|MODE)|TINT_ASSIGN_FASTIN)|HAPED_TOOL_(?:CHECKSUM|TYPE_NO)|MOOTHING_MODE|P(?:F_END_TO_VDI|IND_(?:ASSIGN_TAB_ENABLE|DEF_MASTER_SPIND|RIGID_TAPPING_M_NR)|LINE_(?:FEED_PRECISION|MODE)|OS_TO_VDI)|T(?:ART_(?:AC_FIFO|MODE_MAS(?:K|K_PRT))|ROKE_CHECK_INSIDE)|U(?:MCORR_(?:DEFAULT|RESET_VALUE)|RF_(?:BLOCK_PATH_LIMIT|ORI_PRESMOOTH|SYSTEM_PARAM|VELO_TOL)))|T(?:_M_ADDRESS_EXT_IS_SPINO|ECHNOLOGY_MODE|IME_LIMIT_NETTO_(?:EES_TASK|INT_TASK)|O(?:CARR_(?:BASE_FRAME_NUMBER|CHANGE_M_CODE|FINE_LIM_(?:LIN|ROT)|ROT(?:_(?:ANGLE_(?:INCR|OFFSET)|OFFSET_FROM_FR)|AX_MODE))|FF_(?:ACCEL|MODE|VELO)|OL_(?:C(?:ARRIER_RESET_VALUE|HANGE_(?:ERROR_MODE|M(?:_CODE|ODE))|ORR_M(?:O(?:DE_G43G44|VE_MODE)|ULTIPLE_AXES))|GRIND_AUTO_TMON|MANAGEMENT_(?:MASK|TOOLHOLDER)|OFFSET_DRF_ON|P(?:ARAMETER_DEF_MASK|RESEL_RESET_VALUE)|RESET_(?:NAME|VALUE)|T(?:EMP_COMP_(?:LIMIT|ON)|IME_MONITOR_MASK)))|RA(?:ANG_(?:ANGLE_[12]|BASE_TOOL_[12]|PARALLEL_(?:ACCEL_RES_[12]|VELO_RES_[12]))|C(?:E_(?:COMPRESSOR_OUTPUT|S(?:COPE_MASK|T(?:ARTTRACE_(?:EVENT|STEP)|OPTRACE_(?:EVENT|STEP)))|VARIABLE_(?:INDEX|NAME))|LG_(?:C(?:ONTACT_(?:LOWER_LIMIT|UPPER_LIMIT)|TRLSPI_(?:NR|VERT_OFFSET))|G(?:0_IS_SPECIAL|RINDSPI_(?:HOR_OFFSET|NR|VERT_OFFSET))|HOR_DIR_SUPPORTAX_[12]|SUPPORT_(?:HOR_OFFSET|LEAD_ANGLE|VERT_OFFSET)|VERT_DIR_SUPPORTAX_[12])|ON_CHAIN_[1-8]|YL_(?:BASE_TOOL_(?:[12]|COMP_[12])|DEFAULT_MODE_[12]|ROT_(?:AX_(?:FRAME_[12]|OFFSET_[12])|SIGN_IS_PLUS_[12])))|FO(?:_(?:AXES_IN_(?:[1-9]|[1-2][0-9])|CHANGE_M_CODE|GEOAX_ASSIGN_TAB_(?:[1-9]|[1-2][0-9])|INCLUDES_TOOL_(?:[1-9]|[1-2][0-9])|MODE_MASK|RESET_(?:NAME|VALUE)|TYPE_(?:[1-9]|[1-2][0-9]))|5_(?:AXIS(?:1_[1-4]|2_[1-4]|3_[1-4])|BASE_(?:ORIENT_[1-4]|TOOL_[1-4])|JOINT_OFFSET_(?:[1-4]|PART_[1-4])|N(?:ON_POLE_LIMIT_[1-4]|UTATOR_(?:AX_ANGLE_[1-4]|VIRT_ORIAX_[1-4]))|ORIAX_ASSIGN_TAB_[1-4]|P(?:ART_OFFSET_[1-4]|OLE_(?:LIMIT_[1-4]|TOL_[1-4]))|ROT_(?:AX_OFFSET_[1-4]|OFFSET_FROM_FR_[1-4]|SIGN_IS_PLUS_[1-4])|T(?:CARR_NO_[1-4]|OOL_(?:ROT_AX_OFFSET_[1-4]|VECTOR_[1-4])))|6_(?:BASE_ORIENT_NORMAL_[1-4]|JOINT_OFFSET_2_3_[1-4])|7_EXT_(?:AXIS1_[1-4]|ROT_AX_OFFSET_[1-4]))|NSMIT_(?:BASE_TOOL_(?:[12]|COMP_[12])|POLE_SIDE_FIX_[12]|ROT_(?:AX_(?:FRAME_[12]|OFFSET_[12])|SIGN_IS_PLUS_[12]))))|USE(?:KT_RESET_VALUE|R_FRAME_POWERON_MASK)|W(?:AB_(?:CLEARANCE_TOLERANCE|MAXNUM_DUMMY_BLOCKS)|EIGHTING_FACTOR_FOR_SCALE|ORKAREA_WITH_TOOL_RADIUS)|X_AXIS_IN_OLD_X_Z_PLANE|ZERO_CHAIN_(?:ELEM_NAME|NAME))|S_(?:A(?:DJUST_NUM_AXIS_BIG_FONT|XIS_USAG(?:E|E_ATTRIB))|DISP_(?:COORDINATE_SYSTE(?:M|M_2)|NUM_AXIS_BIG_FONT|PLANE_(?:MILL|TURN))|ENABLE_QUICK_M_CODES|FUNCTION_MASK_(?:D(?:IS(?:P|P_ZOA)|RILL)|MIL(?:L|L_PARAXES)|T(?:ECH|URN))|GRIND_(?:DIAMETER_LENGTH|FUNCTION_MASK|WIDTH_LENGTH)|ISO_(?:ENABLE_(?:DRYRUN|INTERRUPTS)|M_(?:ENABLE_POLAR_COORD|FUNCTION_MASK)|S(?:CALING_SYSTEM|IMULTAN_AXES_START)|T_(?:DEEPHOLE_DRILL_MODE|FUNCTION_MASK))|J_MEA_(?:FIXPOINT|MAGN_GLAS_POS|T_PROBE_APPR_MODE)|M(?:_CODE_(?:ALL_COOLANTS_OFF|C(?:HUCK_(?:CLOSE|OPE(?:N|N_ROT))|OOLANT_(?:1_(?:AND_2_ON|ON)|2_ON))|TAILSTOCK_(?:BACKWARD|FORWARD))|ACHINE_JOG_INTERRUPT_PRIO|EA_FUNCTION_MASK|ILL_(?:PARALLEL_AX(?:1_NAME|2_NAME|3_NAME)|ROUND_AX_NAME))|N(?:AME_TOOL_CHANGE_PROG|UM_AXIS_USED)|ORIAXES_EULER_ANGLE_NAME|PROG_COORDINATE_SYS_CHAN|REV_2_BORDER_TOOL_LENGTH|S(?:IM_DISPLAY_CONFIG|TAT_DISPLAY_BASE|UB_SPINDLE_PARK_POS_Y)|T(?:ECHNOLOG(?:Y|Y_EXTENSION)|M_(?:FUNCTION_MASK|MAG_PLACE_DISTANCE|TOOL_(?:LOAD_(?:DEFAULT_MAG|STATION)|MOVE_DEFAULT_MAG))|OOL_(?:CHANGE_POS_Y|MCODE_FUNC_O(?:FF|N))|U(?:_DISPLAY_BASE|RN_TOOL_FIXING))))|M_(?:A(?:C(?:CESS_HMI_EXIT|TI(?:ON_LOG_MODE|VATE_SEL_USER_DATA))|LARM_ROTATION_CYCLE|NIMATION_TIME_DELAY)|C(?:HANGE_LANGUAGE_MODE|MM_(?:DIRECTORY_SOFTKEY_PATH[1-4]|ENABLE_TOOL_MAGAZINE|FIXED_TOOL_PLACE|POS_COORDINATE_SYSTEM|TOOL_(?:DISPLAY_IN_DIAM|L(?:IFE_CONTROL|OAD_STATION)|MANAGEMENT))|TM_(?:MAX_TOOL_WEAR|POS_COORDINATE_SYSTEM))|D(?:ISPLAY_(?:RESOLUTIO(?:N|N_INCH)|SWITCH_OFF_INTERVAL|TYPE)|RV_DIAG_DO_AND_COMP_NAMES)|ENABLE_CHANNEL_MSG_FILTER|HMI_(?:M(?:EM_LIMIT_USER|ONITOR)|WIDE_SCREEN)|KEYBOARD_(?:STATE|TYPE)|L(?:AYOUT_MODE|CD_CONTRAST)|M(?:A_(?:A(?:UXFU_GROUPS|X(?:_DRIVELOAD_FROM_PLC[12]|ES_SHOW_GEO_FIRST))|COORDINATE_SYSTEM|DISPL_INV_DIR_SPIND_M3|MAX_SKP_LEVEL|NUM_DISPLAYED_CHANNELS|ORIAXES_EULER_ANGLE_NAME|PRESET_(?:FRAMEIDX|MODE)|S(?:IMULATION_MODE|PIND_(?:MAX_POWER|POWER_RANGE)|TA(?:ND_SIMULATION_LIMIT|T_DISPLAY_BASE))|TU_DISPLAY_BASE)|D_TEXT_SWITCH)|P(?:LC_SYMBOL_(?:FILTER|HANDLING|SORT)|ROGRAM_SETTINGS)|S(?:ERVE_EXTCALL_PROGRAMS|HOW_(?:CHANNEL_SPANNING_STATE|TOOLTIP)|INUMERIK_INTEGRATE|PIND_DISPLAY_RESOLUTION|TARTUP_LOGO|W_OPTIONS)|T(?:ECHNOLOGY|OOLTIP_TIME_DELAY|RACE)|USE(?:_CHANNEL_DISPLAY_DATA|R_(?:BEGIN_WRITE_RPA_[1-3]|CLASS_(?:BASE_ZERO_OFF_(?:MA|PA)|CLEAR_RPA|DIRECTORY(?:1_[MP]|2_[MP]|3_[MP]|4_[MP])|OVERSTORE_HIGH|PRESET|READ_(?:GUD_LUD|TOA)|S(?:ELECT_PROGRAM|YS_ZERO_OFF)|TEACH_IN|WRITE_(?:FINE|MAG_WGROUP|PRG_CONDIT|RP(?:A|A_[1-3])|SEA|TOA_(?:A(?:DAPT|SSDNO)|EC|GEO|NAME|S(?:C|UPVIS)|TYPE|WEAR)|ZOA))|END_WRITE_RPA_[1-3]|WRITE_(?:CYCFRAME|EXTFRAME|PARTFRAME|T(?:OOLFRAME|RAFRAME)|WPFRAME)))|WRITE_(?:TOA_(?:FINE_LIMIT|LIMIT_MASK)|ZOA_FINE_LIMIT))|N(?:_(?:A(?:CCESS_(?:EXEC_C(?:MA|ST|US)|WRITE_(?:C(?:MA|ST|US)|MACCESS|SACCESS|UACCESS))|LARM_(?:CLR_NCSTART_W_CANCEL|PAR_DISPLAY_TEXT|REACTION_CHAN_NOREADY)|S(?:SIGN_CHAN_TO_MODE_GROUP|UP_(?:EDIT(?:_PROTECTION_LEVEL|ABLE)|START_(?:MASK|PRIO_LEVEL)))|U(?:TOMATIC_MEM_RECONFIG_FILE|XFU_(?:GROUP_SPEC|MAXNUM_GROUP_ASSIGN))|X(?:C(?:HANGE_MASK|ONF_(?:LOGIC_MACHAX_TAB|MACHAX_NAME_TAB)|T_(?:AXCONF_ASSIGN_TAB(?:[1-9]|1[0-6])|FUNCTION_MASK|NAME_TAB))|IS_VAR_SERVER_SENSITIVE))|BAG_MASK|C(?:C(?:_(?:ASSIGN_FASTOUT_MASK|HW_DEBUG_MASK|T(?:DA_PARAM_UNIT|OA_PARAM_UNIT)|V(?:DI_(?:IN_DATA|OUT_DATA)|ERSION_INFO))|S_T(?:DA_PARAM_UNIT|OA_PARAM_UNIT))|ENTRAL_LUBRICATION|HAMFER_NAME|NC_LOCK_WARNING_TIME|O(?:LLISION_(?:CONFIG|INIT|PREP_CALC_TIME|SAFETY_DIST|TOLERANCE)|M(?:_(?:CONFIGURATION|IPO_(?:STRATEGY|TIME_RATIO)|TIMING)|PAR_(?:ASSIGN_ANA_INPUT_[12]|TYPE_[12]))|N(?:T(?:OUR(?:_(?:DEF_ANGLE_NAME|SAMPLING_FACTOR)|HANDWH_IMP_PER_LATCH)|ROL_UNIT_LOGIC_ADDRESS)|VERT_SCALING_SYSTEM)|REFILE_NAME|UPLE_CYCLE_MASK)|TRLOUT_LEAD_TIM(?:E|E_MAX)|YCLES_ONLY_IN_CYCDIR)|D(?:_NO_FCT_CYCLE_NAME|E(?:FAULT_VALUES_MEM_MASK|PTH_OF_LOGFILE_OP(?:T|T_PF))|I(?:R_VECTOR_NAME_TAB|SPLAY_(?:FUNCTION_MASK|MODE_POSITION))|PIO_(?:LOGIC_ADDRESS_(?:IN|OUT)|RANGE_(?:ATTRIBUTE_(?:IN|OUT)|LENGTH_(?:IN|OUT)))|R(?:A(?:M_FILESYST(?:_(?:CONFIG|SAVE_MASK)|EM_MASK)|W_POS_TRIGGER_TIME)|IVE_(?:DIAGNOSIS|FUNCTION_MASK|I(?:NVERTER_CODE|S_ACTIVE)|LOGIC_(?:ADDRESS|NR)|MODULE_TYPE|T(?:ELEGRAM_TYPE|YP(?:E|E_DP)))|YRUN_MASK))|E(?:ES_(?:LOCAL_ENABLE|M(?:AX_MOUNT_TIME|O(?:DE_INFO|UNT_FILE))|NC_NAME|WRITE_SIM_WORKPATH)|N(?:ABLE_(?:ALARM_MASK|CHAN_AX_GAP)|C_(?:HANDWHEEL_(?:INPUT_NR|MODULE_NR|SEGMENT_NR)|SSI_BAUD_RATE))|ULER_ANGLE_NAME_TAB|XTE(?:NSIONS_OF_BIN_FILES|RN_(?:CHAN_SYNC_M_NO_M(?:AX|IN)|D(?:IGITS_(?:OFFSET_NO|TOOL_NO)|OUBLE_TURRET_ON)|FLOATINGPOINT_PROG|G_NO_MAC_CYCL(?:E|E_NAME)|IN(?:CREMENT_SYSTEM|TERRUPT_(?:BITS_M96|NUM_(?:ASUP|RETRAC)))|M(?:_NO_(?:DISABLE_INT|MAC_CYCL(?:E|E_NAME)|SET_INT)|EAS_G31_P_SIGNAL)|PRINT_(?:DEVICE|MODE)|TOOLPROG_MODE)))|F(?:ASTIO_(?:ANA_(?:INPUT_WEIGHT|NUM_(?:INPUTS|OUTPUTS)|OUTPUT_WEIGHT)|DIG_(?:NUM_(?:INPUTS|OUTPUTS)|SHORT_CIRCUIT))|ILE_ONLY_WITH_EXTENSION|PU_(?:CTRLWORD_INIT|E(?:RROR_MODE|XEPTION_MASK))|RAME_(?:ANGLE_INPUT_MODE|GEOAX_CHANGE_MODE|SAVE_MASK))|G(?:53_TOOLCORR|EAR_CHANGE_WAIT_TIME|MMC_INFO_NO_UNI(?:T|T_STATUS)|UD_AREA_SAVE_TAB)|H(?:ANDWH(?:_(?:IMP_PER_LATCH|REVERSE|TRUE_DISTANCE|VDI_REPRESENTATION)|EEL_(?:FILTER_TIME|INPUT|LOGIC_ADDRESS|MODULE|SEGMENT))|W_(?:ASSIGN_(?:ANA_FAST(?:IN|OUT)|DIG_FAST(?:IN|OUT))|CLOCKED_MODULE_MASK|LEAD_TIME_FASTIO|SERIAL_NUMBER|UPDATE_RATE_FASTIO))|I(?:BN_LOAD_FASTOPT|GNORE_SINGLEBLOCK_MASK|N(?:DEX_AX_(?:LENGTH_POS_TAB_[12]|MODE|POS_TAB_[12])|FO_(?:CROSSCHECK_CYCLE_TIME|FREE_MEM_(?:CC_MD|D(?:PR|YNAMIC)|STATIC)|NUM_SAFE_FILE_ACCESS|PROFISAFE_CYCLE_TIME|SAFE(?:_SRDP_CYCLE_TIME|TY_CYCLE_TIME))|I(?:_FILE_MODE|T_MD)|T(?:_INCR_PER_(?:DEG|MM)|ER(?:_VECTOR_NAME_TAB|MEDIATE_POINT_NAME_TAB)))|PO_(?:CYCLE_TIME|MAX_LOAD|PARAM_(?:NAME_TAB|THREAD_NAME_TAB)|SYSCLOCK_TIME_RATIO)|S_(?:AUTOMATIC_MEM_RECONFIG|CONTINOUS_DATA_SAVE_ON))|JOG_(?:INC(?:_MODE_LEVELTRIGGRD|R_SIZE_TAB)|MODE_(?:KEYS_EDGETRIGGRD|MASK))|L(?:ANG_SUB_(?:NAME|PATH)|EN_PROTOCOL_FILE|INK_(?:BAUDRATE_SWITCH|DYNMSG_ALARM_MASK|LIFECYCLE_MAX_LOOP|RETRY_CTR|TERMINATION)|UD_EXTENDED_SCOPE)|M(?:_NO_FCT_(?:CYCL(?:E|E_(?:NAME|PAR))|EOP|STOPRE)|A(?:CH_MODEL_MODE|PPED_FRAME_MASK|X(?:_TOOLS_PER_MULTITOOL|NUM_(?:REPLACEMENT_TOOLS|USER_DATA_(?:FLOAT|HEX|INT))))|D_(?:FILE_STYLE|MODE_MASK)|EAS_(?:CENTRAL_SOURCE|PROBE_(?:DELAY_TIME|LOW_ACTIVE|OFFSET|SOURCE)|TYPE)|I(?:N_CONTOUR_SAMPLING_TIME|RROR_(?:REF_AX|TOGGLE))|M(?:_(?:ACTFILESYS_LOG_FILE_MEM|C(?:C_(?:MD_MEM_SIZE|STATION_CHAN_MASK)|EC_MAX_POINTS|HAN_HASH_TABLE_SIZE|OM_(?:COMPRESS_METHOD|TASK_STACK_SIZE)|YC_DATA_MEM_SIZE)|D(?:IR_HASH_TABLE_SIZE|R(?:AM_FILE_MEM_SIZE|IVE_TASK_STACK_SIZE))|E(?:_FILE_MEM_SIZE|ES_(?:BUFFER_SIZE|ENABLE|FILE_MEM_SIZE|NUM_BUFFERS)|NABLE_TOOL_ORIENT|PSPARAM_DIMENSION|XT(?:_PROG_(?:BUFFER_SIZE|NUM)|COM_TASK_STACK_SIZE|ERN_(?:CNC_SYSTEM|GCODE_SYSTEM|LANGUAGE|MAXNUM_OEM_GCODES)))|F(?:ILE_HASH_TABLE_SIZE|LASH(?:_FILE_SYSTEM_SIZE|FILESYS_MEM)|RAME_FINE_TRANS)|G(?:FRAME_FINE_TRANS|UD_VALUES_MEM)|I(?:NCOA_MEM_SIZE|PO_TASK_STACK_SIZE)|KIND_OF_SUMCORR|L(?:INK_NUM_OF_MODULES|UD_HASH_TABLE_SIZE)|M(?:_FILE_MEM_SIZE|A(?:INTENANCE_MON|X(?:_(?:CUTTING_EDGE_(?:NO|PERTOOL)|HIERARCHY_ENTRIES|NUM_OF_HIERARCHIES|S(?:IZE_OF_LUD_VALUE|UMCORR_PER_CUTTEDGE)|TRACE_LINK_POINTS)|NUM_(?:3D_(?:COLL(?:_PAIRS|ISION)|FACET(?:S|S_INTERN)|INT(?:ERFACE_IN|RERFACE_IN)|PROT_(?:AREA(?:_ELEM|S)|GROUPS)|T_PROT_ELEM|WPFX_PROT_ELEM)|ALARM_ACTIONS|KIN_(?:CHAIN(?:_ELEM|S)|SWITCHES))))|EMORY_CONFIG_MASK)|N(?:C(?:K_HASH_TABLE_SIZE|U_LINK_MASK)|UM_(?:AN_TIMER|C(?:C(?:_(?:M(?:AG(?:AZINE_PARAM|LOC_PARAM)|ON_PARAM|TLOC_PARAM|ULTITOOL_PARAM)|T(?:DA_PARAM|OA_PARAM))|S_(?:M(?:AG(?:AZINE_PARAM|LOC_PARAM)|ON_PARAM|TLOC_PARAM|ULTITOOL_PARAM)|T(?:DA_PARAM|OA_PARAM)))|P_MODUL(?:_LEAD|ES)|U(?:RVE_(?:POLYNOM(?:S|S_DRAM)|SEG(?:_LI(?:N|N_DRAM)|MENT(?:S|S_DRAM))|TAB(?:S|S_DRAM))|TTING_EDGES_IN_TOA))|D(?:I(?:R_IN_FILESYSTEM|ST_REL_PER_MAGLOC)|RS_GRINDING_PATHS)|FILES_(?:IN_FILESYSTEM|PER_DIR)|G(?:LOBAL_(?:BASE_FRAMES|G_FRAMES|USER_FRAMES)|UD_(?:MODULES|NAMES_(?:AXIS|CHAN|NCK)))|KIN_TRAFOS|LOCS_WITH_DISTANCE|M(?:A(?:GAZIN(?:E|E_LOCATION)|X_FUNC_(?:NAMES|PARAM))|MC_UNITS|ULTITOO(?:L|L_LOCATIONS))|PROTECT_AREA_NCK|R_PARAM_NCK|S(?:U(?:BDIR_PER_DIR|MCORR)|Y(?:NACT_GUD_(?:AXIS|BOOL|CHAR|INT|REAL|STRING)|STEM_FILES_IN_FS))|T(?:OO(?:L|L(?:_(?:ADAPTER|CARRIER|ENV)|HOLDERS))|RAFO_DATA_SETS)|USER_MACROS))|P(?:LC(?:_TASK_STACK_SIZE|BG_TASK_STACK_SIZE|INT_TASK_STACK_SIZE)|ROTOC_(?:FILE_BUFFER_SIZE|NUM_(?:ETPD_(?:OEM_LIST|STD_LIST)|FILES|SERVO_DATA)|SESS_ENAB_USER))|S(?:_FILE_MEM_SIZE|ERVO_(?:FIFO_SIZE|TASK_STACK_SIZE)|IZEOF_LINKVAR_DATA)|T(?:_FILE_MEM_SIZE|OOL_MANAGEMENT_(?:MASK|TRACE_SZ)|RACE_(?:LINK_DATA_FUNCTION|VDI_SIGNAL)|YPE_(?:CC(?:_(?:M(?:AG(?:AZINE_PARAM|LOC_PARAM)|ON_PARAM|TLOC_PARAM|ULTITOOL_PARAM)|T(?:DA_PARAM|OA_PARAM))|S_(?:M(?:AG(?:AZINE_PARAM|LOC_PARAM)|ON_PARAM|TLOC_PARAM|ULTITOOL_PARAM)|T(?:DA_PARAM|OA_PARAM)))|OF_CUTTING_EDGE))|U(?:_FILE_MEM_SIZE|SER_(?:FILE_MEM_MINIMUM|MEM_(?:BUFFERE(?:D|D_TYPEOF)|D(?:PR|YNAMIC)))))|C_CMD_TIMEOUT)|ONITOR_(?:ADDRESS|DISPLAY_(?:INT|REAL)|INPUT_(?:INT|REAL|STROBE)))|N(?:C(?:_(?:LANGUAGE_CONFIGURATION|SYS_CODE_CONF_NAME_TAB|USER_(?:CODE_CONF_NAME_TAB|EXTERN_GCODES_TAB))|BFRAME_(?:POWERON_MASK|RESET_MASK)|K_(?:EG_FUNCTION_MASK|LEAD_FUNCTION_MASK|PCOS_TIME_RATIO|TRAIL_FUNCTION_MASK)|U_LINK(?:_CONNECTIONS|NO))|ORMAL_VECTOR_NAME_TAB|U(?:M_EG|TATION_ANGLE_NAME))|O(?:EM_GLOBAL_INFO|PERATING_MODE_(?:DEFAULT|EXTENDED)|RI(?:ENTATION_NAME_TAB|PATH_LIFT_(?:FACTOR_NAME|VECTOR_TAB))|SCILL_MODE_MASK|VR_(?:AX_IS_GRAY_CODE|F(?:ACTOR_(?:AX_SPEED|FEEDRATE|LIMIT_BIN|RAPID_TRA|SPIND_SPEED)|EED_IS_GRAY_CODE|UNCTION_MASK)|R(?:APID_IS_GRAY_CODE|EFERENCE_IS_(?:MIN_FEED|PROG_FEED))|SPIND_IS_GRAY_CODE))|P(?:ERM(?:ANENT_(?:FEED|ROT_AX_FEED|SPINDLE_FEED)|ISSIVE_FLASH_TAB)|LC(?:_(?:ANA_(?:IN_(?:LOGIC_ADDRESS|NUM)|OUT_(?:LOGIC_ADDRESS|NUM))|CYCL(?:E_TIM(?:E|E_AVERAGE)|IC_TIMEOUT)|D(?:EACT_IMAGE_LADDR_(?:IN|OUT)|IG_(?:IN_(?:LOGIC_ADDRESS|NUM)|OUT_(?:LOGIC_ADDRESS|NUM)))|IPO_TIME_RATIO|MCP_(?:ADDRESS_(?:IN|OUT)|CONNECT)|OB(?:1_TRACE_DEPTH|35_TRACE_DEPTH|40_TRACE_DEPTH)|RUNNINGUP_TIMEOUT|TASK_RUNTIME_(?:STOP|WARNING))|I(?:NT(?:_POSCTRL_TIME_RATIO|ERN_LOGIC_ADDRESS_(?:IN|OUT))|O_(?:IN_UPDATE_TIME|LOGIC_ADDRESS_(?:IN|OUT)|NUM_BYTES_(?:IN|OUT)|TYPE_REPRESENTATION)))|O(?:_WITHOUT_POLY|S(?:_(?:DYN_MODE|TAB_SCALING_SYSTEM)|CTRL_(?:CYCLE_(?:D(?:E(?:LAY|SVAL_DELAY)|IAGNOSIS)|TIME)|DESVAL_DELAY|SYSCLOCK_TIME_RATIO)))|R(?:E(?:P(?:_(?:COM_TASK_CYCLE_RATIO|DRIVE_TASK_CYCLE_RATIO|PLCBG_TASK_CYCLE_RATIO)|ROCESSING_LEVEL)|VENT_SYNACT_LOCK)|O(?:FI(?:BUS_(?:ALARM_(?:ACCESS|MARKER)|S(?:DB_(?:NUMBER|SELECT)|HUTDOWN_TYPE)|TRACE_(?:ADDRESS|FILE_SIZE|STAR(?:T|T_EVENT)|TYPE))|SAFE_(?:I(?:N_(?:A(?:DDRESS|SSIGN)|ENABLE_MASK|FILTER|NAME|SUB(?:S|S_ENAB_MASK))|PO_(?:RESERVE|TIME_RATIO))|MASTER_ADDRESS|OUT_(?:A(?:DDRESS|SSIGN)|ENABLE_MASK|FILTER|NAME)))|G_(?:EVENT_(?:NAME|PATH)|FUNCTION_MASK|SD_(?:POWERON_INIT_TAB|RESET_SAVE_TAB)|TEST_MASK)|T(?:_AREA_(?:3D_TYPE_NAME_TAB|TOOL_MASK)|AREA_GEOAX_CHANGE_MODE|OC(?:_(?:FILE_MEM|IPOCYCLE_CONTROL|PREPTIME_CONTROL)|OL_FILE_MODE)))))|R(?:_PARAM_NCK_NAME|ADIUS_NAME|E(?:BOOT_DELAY_TIME|LEASE_PREP_CPU_POWER|POS_MODE_MASK)|O(?:OT_KIN_ELEM_NAME|T_VECTOR_NAME_TAB)|UN_OVERRIDE_0)|S(?:AFE(?:_(?:ALARM_SUPPRESS_LEVEL|D(?:IAGNOSIS_MASK|RIVE_LOGIC_ADDRESS)|GLOB_(?:ACT_CHECKSUM|CFG_CHANGE_DATE|DES_CHECKSUM|PREV_CONFIG)|IN(?:_HW_ASSIGN|FO_(?:DRIVE_LOGIC_ADDR|TELEGRAM_TYPE))|MOD(?:E|E_MASK)|OUT_HW_ASSIGN|P(?:S_DRIVE_LOGIC_ADDR|ULSE_DIS_TIME_BUSFAIL)|RDP_(?:ASSIGN|CONNECTION_NR|E(?:NABLE_MASK|RR_REAC)|FILTER|ID|LADDR|NAME|SUBS|TIMEOUT)|S(?:DP_(?:ASSIGN|CONNECTION_NR|E(?:NABLE_MASK|RR_REAC)|FILTER|ID|LADDR|NAME|TIMEOUT)|PL_(?:ST(?:ART_TIMEOUT|OP_MODE)|USER_DATA)|RDP_IPO_TIME_RATIO))|TY_SYSCLOCK_TIME_RATIO)|CALING_(?:FACTORS_USER_DEF|SYSTEM_IS_METRIC|USER_DEF_MASK|VALUE_INCH)|E(?:ARCH_RUN_MODE|RUPRO_MASK)|I(?:EM_TRACEFILES_CONFIG|M_ENVIRONMENT|NAMICS_(?:ALARM_MASK|MAX_SLAVE_ADDRESS))|LASH_MASK|PRINT_FORMAT_P_(?:CODE|DECIMAL)|T(?:A(?:RT_LOCK_TIMEOUT|T_NAME)|OP_MODE_MASK)|UPPRESS_(?:ALARM_MAS(?:K|K_2)|SCREEN_REFRESH)|W_CAM_(?:ASSIGN_(?:FASTOUT_[1-4]|TAB)|COMP_NCK_JITTER|M(?:INUS_LEAD_TIME|ODE)|PLUS_LEAD_TIME|TIMER_FASTOUT_MASK)|YSCLOCK_(?:CYCLE_TIME|SAMPL_TIME_RATIO))|T(?:_NO_FCT_CYCLE_(?:MODE|NAME)|ASK_(?:SLEEP_TIME|TIME_AVERAGE_CONFIG)|C(?:A_CYCLE_NAME|I_TRACE_ACTIVE)|IME(?:_LIMIT_(?:NETTO_(?:COM_TASK|DRIVE_TASK|PLCBG_TASK)|PLCINT_TAS(?:K|K_DIAG))|OUT_LINK_COMMUNICATION)|OOL(?:_(?:CHANGE_TIME|D(?:ATA_CHANGE_COUNTER|EFAULT_DATA_MASK)|RESETMON_MASK|UNLOAD_MASK)|TYPES_ALLOWED)|RACE_(?:PATHNAME|S(?:AVE_OLD_FILE|ELECT))|U_NAME)|U(?:NLOCK_EDIT_MODESWITCH|PLOAD_(?:CHANGES_ONLY|MD_CHANGES_ONLY)|SER_DATA_(?:FLOAT|HEX|INT|PLC_ALAR(?:M|M_ASSIGN)))|V(?:DI_(?:FUNCTION_MASK|UPDATE_IN_ONE_IPO_CYCLE)|ERSION_INFO)|W(?:ALIM_GEOAX_CHANGE_MODE|PD_INI_MODE))|S_(?:A(?:C(?:CESS_(?:ACTIVATE_CTRL_E|C(?:AL_TOOL_PROBE|LEAR_RPA)|EDIT_CTRL_E|RE(?:AD_(?:GUD_LUD|T(?:M|M_ALL_PARAM))|SET_SERV_PLANNER)|S(?:ET_(?:ACT_VALUE|SOFTKEY_ACCESS)|HOW_SBL2)|T(?:EACH_IN|M_(?:MAGAZINE_POS|TOOL(?:_(?:CREATE|DELETE|LOAD|M(?:EASURE|OVE)|REACTIVATE|UNLOAD)|EDGE_(?:CREATE|DELETE))))|WRITE_(?:BASEFRAME|C(?:A_(?:MACH_(?:AUTO|JOG)|TOOL)|YCFRAME)|EXTFRAME|FINE|GUD_LUD|P(?:ARTFRAME|R(?:G_COND|OG(?:LIST|RAM)))|RPA|SE(?:A|TFRAME)|T(?:M_(?:A(?:DAPT|LL_PARAM|SSDNO)|EC|G(?:EO|RIND)|NAME|S(?:C|UPVIS)|TYPE|W(?:EA(?:R|R_DELTA)|GROUP))|OOLFRAME|RAFRAME)|USERFRAME|WP(?:C_COUNTER|FRAME)))|T_VALUE_SPIND_MODE)|XES_SHOW_GEO_FIRST)|BLOCK_SEARCH_MODE_MAS(?:K|K_JS)|DISP_RES_(?:ANGLE|INC(?:H|H_(?:CUT_RATE|FEED_P_(?:REV|T(?:IME|OOTH))))|M(?:M|M_(?:CONST_CUT_RATE|FEED_PER_(?:REV|T(?:IME|OOTH))))|ROT_(?:AX_FEED|WO)|SPINDLE)|ENABLE_(?:COORDINATE_(?:ACS|REL)|GSM_MODEM|HANDWHEEL_WINDOW|LADDER_(?:DB_ADDRESSES|EDITOR)|PROGLIST_(?:INDIVIDUAL|MANUFACT|USER))|F(?:RAMES_ACT_IMMEDIATELY|UNCTION_MASK_(?:SIM|TECH))|GRIND_FUNCTION_MASK|J_MEA_(?:C(?:AL_(?:HEIGHT_FEEDAX|RING_DIAM)|OLL_MONIT_(?:FEED|POS_FEED))|M(?:_DIS(?:T|T_(?:MANUELL|TOOL_(?:LENGTH|RADIUS)))|EASURING_FEED)|T_PROBE_(?:APPR_AX_DIR|DIAM_RAD|MEASURE_DIST))|M(?:AX(?:_SKP_LEVEL|NUM_WAITM_USER)|EA_(?:ACCESS_EXEC|C(?:AL_(?:EDGE_NUM|TP(?:_NUM|W_NUM)|WP_NUM)|M_ROT_AX_POS_TOL)|FUNCTION_MASK|T_PROBE_THICKNESS))|NUM_DISPLAYED_CHANNELS|O(?:NLY_MKS_DIST_TO_GO|RDER_DISPLAYED_CHANNELS)|PROGRAM_CONTROL_MODE_MASK|S(?:ET_ACT_VALUE|PIND_(?:DRIVELOAD_FROM_PLC[12]|MAX_POWER|POWER_RANGE)|TAT_DISPLAY_BASE|WITCH_TO_MACHINE_MASK)|T(?:EACH_MODE|M_WRITE_(?:LIMIT_MASK|WEAR_(?:ABS_LIMIT|DELTA_LIMIT))|U_DISPLAY_BASE)|WRITE_FRAMES_FINE_LIMIT)))|O(?:C_LOOKAH_NUM_CHECKED_BLOCKS|N_(?:A(?:SUP_MASK|X(?:CNT|IS_FUNCTION_MASK))|CO(?:LL(?:CHECK_LEVEL|ISION_MASK)|MP_MASK)|DRIVE_(?:CNT|EXTENSION_MASK|MASK)|E(?:LEC_TRANSFE(?:R|R_CP)|XTERN_LANGUAGE)|FFW_MODE_MASK|H(?:ANDLING|MI_(?:FUNCTION_MASK|MASK))|IPO_FUNCTION_MASK|NUM_(?:A(?:DD_AXES_IN_SYSTEM|XES_IN_SYSTEM)|CHANNELS|DRIVEBASED_SAFE_AXES|IPO_AXES|L(?:EAD_LINK_AXES|INK_AXES)|MODE_GROUPS|PLC_CTRL_AXES|S(?:AFE_AXES|PL_IO))|P(?:ERFORMANCE_INDEX|L(?:ASTIC|C_(?:C_USER_MEM_SIZE|FUNCTION_MASK|USER_MEM_SIZE))|RO(?:FIBUS|G_MASK))|S(?:AFE_(?:FUNCTION_MASK|PLC_LOGIC)|I(?:MODRIVE_FUNCTION_MASK|NAMICS_FUNCTION_MASK)|YSTEM_(?:FUNCTION_MASK|INFO))|T(?:ECHNO_(?:EXTENSION_MASK|FUNCTION_MAS(?:K|K_1))|RAFO_TYPE_MASK)|USER_MEM_(?:BUFFERED|DYNAMIC)))|S(?:A_(?:A(?:A_OFF_LIMIT|DISPOSA_VALUE|SSIGN_FEED_PER_REV_SOURCE)|DEFAULT_SCALE_FACTOR_AXIS|EXTERN_REF_POSITION_G30_1|FIXED_STOP_(?:SWITCH|TORQUE|WINDOW)|IPOBRAKE_BLOCK_EXCHANGE|JOG_POSITION|LEAD_(?:OFFSET_(?:IN_POS|OUT_POS)|SCALE_(?:IN_POS|OUT_POS)|TYPE)|M19_SPO(?:S|SMODE)|OSCILL_(?:CTRL_MASK|DWELL_TIME[12]|END_POS|IS_ACTIVE|NUM_SPARK_CYCLES|REVERSE_POS[12]|START_POS|VELO)|SPIND_(?:CONSTCUT_S|M(?:AX_VELO_(?:G26|LIMS)|IN_VELO_G25)|S|SPEED_TYPE|USER_VELO_LIMIT)|TEMP_COMP_(?:ABS_VALUE|REF_POSITION|SLOPE)|WORKAREA_(?:LIMIT_(?:MINUS|PLUS)|MINUS_ENABLE|PLUS_ENABLE))|C(?:_(?:A(?:BSBLOCK_ENABLE|CTNUM_SURF_GROUPS|PPROACH_FEED|X_ADJUST_FEED)|C(?:ART_JOG_MODE|O(?:MPRESS_(?:CONTUR_TOL|ORI_(?:ROT_TOL|TOL))|N(?:E_ANGLE|TPREC)|RNER_SLOWDOWN_(?:CRIT|END|OVR|START)|UPLE_RATIO_1)|RIT_SPLINE_ANGLE|UT(?:COM_(?:ACT_DEACT_CTRL|CLSD_CONT|DECEL_LIMIT|G40_STOPRE)|DIRMOD|MOD_PLANE_TOL))|D(?:EFAULT_(?:FEED|ROT_FACTOR_R|SCALE_FACTOR_P)|RY_RUN_FEE(?:D|D_MODE))|EXT(?:_PROG_PATH|ERN_(?:DOUBLE_TURRET_DIST|FIXED_FEEDRATE_F1_F9))|FRAME_OFFSET_INCR_PROG|IS_SD_MAX_PATH_(?:ACCEL|JERK)|JOG_(?:CIRCLE_(?:CENTRE|END_ANGLE|MODE|RADIUS|START_ANGLE)|FEED_PER_REV_SOURCE|GEOAX_MODE_MASK)|M(?:AX_BLOCKS_IN_IPOBUFFER|I(?:N(?:_(?:CURV_RADIUS|SURF_RADIUS)|FEED|TIME_BETWEEN_STROKES)|RROR_TOOL_(?:LENGTH|WEAR)))|NIBPUNCH_PRE_START_TIME|O(?:FF_ORI_LIMIT|RI(?:_(?:JOG_MODE|SMOOTH_(?:DIST|TOL))|PATH_SMOOTH_(?:DIST|TOL)|SO(?:LH_INCLINE_TOL|N_(?:DIST|TOL)))|VR_RAPID_FACTOR)|P(?:A_(?:ACTIV_IMMED|C(?:ENT_(?:ABS|ORD)|ONT_(?:ABS|NUM|ORD|TYP))|LIM_3DIM|MINUS_LIM|ORI|PLUS_LIM|T_W)|UNCH_DWELLTIME)|S(?:D_MAX_PATH_(?:ACCEL|JERK)|ERUPRO_SYNC_MASK|INGLEBLOCK2_STOPRE|MOOTH_(?:CONTUR_TOL|ORI_TOL)|PIND_ASSIGN_TAB|TOP_CUTCOM_STOPRE|URF_(?:PERF_ADJUST|SMOOTHING_LEVEL))|T(?:ARGET_BLOCK_INCR_PROG|HREAD_(?:RAMP_DISP|START_ANGLE)|O(?:CARR_FINE_CORRECTION|F(?:F_LIMI(?:T|T_MINUS)|RAME_MODE)|OL_(?:LENGTH_(?:CONS(?:T|T_T)|TYPE)|O(?:FFSET_INCR_PROG|RI_CONST_[MT])|TEMP_COMP)))|WEAR_(?:SIG(?:N|N_CUTPOS)|TRANSFORM))|S_(?:AST_MMC(?:_NEWCONF_HANDSHAKE|A)|CIRCLE_RAPID_FEED|DRILL(?:_(?:MID_MAX_ECCENT|SPOT_DIST|TAPPING_SET_(?:GG[1-2]?[0-9]|MC))|ING_AXIS_IS_Z)|EASY_(?:D(?:RILL_DEEP_(?:DF|FD1|V[12])|WELL_TIME)|SAFETY_CLEARANCE|THREAD_RETURN_DIST)|F(?:RICT_OPT_(?:ACT_STEP|DIR_MINUS|FEE(?:D|D_ROT)|RADIU(?:S|S_ROT)|STEP)|UNCTION_MASK_(?:DRILL_SET|MILL_(?:SET|TOL_SET)|SWIVEL_SET|T(?:ECH_SET|URN_SET)))|GRIND_(?:CONT_(?:BLANK_OFFSET|RELEASE_(?:ANGLE|DIST))|FUNCTION_MASK|MEA_KIN_TOL)|ISO_(?:M_(?:DRILLING_(?:AXIS_IS_Z|TYPE)|FUNCTION_MASK|RETRACTION_(?:DIR|FACTOR)|TAPPING_SET_MC)|T_(?:DWELL_TIME_UNIT|FUNCTION_MASK|RETRACTION_FACTOR))|J_MEA_(?:PROTOCOL_FILE|SET_PROBE_MONO)|M(?:A(?:JOG_(?:RELEASE_PLANE|SAFETY_CLEARANCE)|X_INP_FEED_PER_(?:REV|T(?:IME|OOTH)))|EA_(?:AVERAGE_VALU(?:E|E_NUM)|E(?:DGE_SAVE_ANG|MPIRIC_VALU(?:E|E_NUM))|F(?:EED_(?:CIRCLE|F(?:AST_MEASURE|EEDAX_VALUE)|MEASUR(?:E|E_DEG)|P(?:LANE_VALUE|OS_DEG)|RAPID_IN_PERCENT)|UNCTION_MASK)|KIN_(?:BALL_VEC|DM_TOL|M(?:IN_ANG_(?:POS|TRIANGLE)|ODE)|VALUE)|PROTOCOL_USER_EXT|RESULT_(?:DISPLAY|MRD)|SIM_(?:ENABLE|MEASURE_DIFF)|TP_FEED_MEASURE)|ILL_(?:CONT_INITIAL_RAD_FIN|ENGRAVE_POINT_RAD|SWIVEL_(?:ALARM_MASK|RESET_(?:MODE|RETRACT|TRACK))|T(?:OL_(?:FACTOR_(?:FINISH|NORM|ROUGH|SEMIFIN)|VALUE_(?:FINISH|NORM|ROUGH|SEMIFIN))|RAORI_USERCYCLE_NAME)))|SUB_SPINDLE_REL_POS|TURN_(?:CONT_(?:BLANK_OFFSET|INTER(?:_RETRACTION|RUPT_TIME)|MIN_REST_MAT_AX[12]|RELEASE_(?:ANGLE|DIST)|T(?:OOL_BEND_RETR|RACE_ANGLE|URN_RETRACTION)|VARIABLE_DEPTH)|FI(?:N_FEED_PERCENT|XED_STOP_(?:DIST|F(?:EED|ORCE)|RETRACTION))|GROOVE_DWELL_TIME|PART_OFF_(?:CTRL_(?:DIST|F(?:EED|ORCE))|RETRACTION)|ROUGH_(?:I_RELEASE_DIST|O_RELEASE_DIST)|THREAD_RELEASE_DIST)))|N(?:_(?:AXCT_SWWIDTH|C(?:EC_(?:[01]|BAS_(?:[01]|STORE_[01])|C(?:AL(?:C|C_ADD)|OMP_(?:[01]|STORE_[01]))|TABLE_(?:ENABLE|WEIGHT))|O(?:MPAR_THRESHOLD_[12]|RR_TRAFO_(?:DIR_MAX|LIN_MAX)))|JOG_(?:CONT_MODE_LEVELTRIGGRD|R(?:EV_(?:IS_ACTIVE|SET_VELO)|OT_AX_SET_VELO)|S(?:ET_VELO|PIND_SET_VELO)|VAR_INCR_SIZE)|PA_(?:ACTIV_IMMED|C(?:ENT_(?:ABS|ORD)|ONT_(?:ABS|NUM|ORD|TYP))|LIM_3DIM|MINUS_LIM|ORI|PLUS_LIM|T_W)|S(?:INGULARITY_THRESHOLD|W_CAM_(?:MINUS_(?:POS_TAB_[1-4]|TIME_TAB_[1-4])|PLUS_(?:POS_TAB_[1-4]|TIME_TAB_[1-4]))))|S_(?:AST_MMC_(?:DEFAULT_IS_PCU|HANDLER_NAME)|GRIND_FUNCTION_MASK|J_MEA_FUNCTION_MASK_(?:PIECE|TOOL)|MEA_(?:ALARM_MASK|C(?:AL_EDGE_(?:BASE_AX[12]|MINUS_DIR_AX[12]|PLUS_DIR_AX[12]|UPPER_AX2)|M_(?:FEEDFACTOR_[12]|M(?:AX_(?:FEEDRATE|PERI_SPEED|REVOLUTIONS)|EASURING_ACCURACY|IN_FEEDRATE)|SPIND_ROT_DIR))|FUNCTION_MAS(?:K|K_(?:PIECE|T(?:OOL|URN)))|INPUT_(?:PIECE_PROBE_SUB|TOOL_PROBE_SUB)|RESULT_OFFSET_TAB_(?:LEN[1-6]|RAD[1-6])|T(?:_(?:CIRCULAR_ARC_DIST|MAX_STEPS|PROBE_(?:MANUFACTURER|OFFSET))|P(?:_(?:AX_DIR_AUTO_CAL|CAL_MEASURE_DEPTH|EDGE_DISK_SIZE|FEED|STATUS_GEN|T(?:RIG_(?:MINUS_DIR_AX[1-3]|PLUS_DIR_AX[1-3])|YPE))|W_(?:AX_DIR_AUTO_CAL|CAL_MEASURE_DEPTH|EDGE_DISK_SIZE|FEED|STATUS_GEN|T(?:RIG_(?:MINUS_DIR_AX[1-3]|PLUS_DIR_AX[1-3])|YPE))))|WP_(?:BALL_DIAM|FEED|POS_DEV_AX[12]|STATUS_(?:GEN|RT)|TRIG_(?:MINUS_DIR_AX[1-3]|PLUS_DIR_AX[1-3])))|TM_FUNCTION_MASK_SET))))\b
          scope: support.variable.nck.machdata.s840d_gcode
          set: array-index

        # unknown NC-Variable
        - match: \$?\w*\b
          scope: support.variable.nck.unknown.s840d_gcode invalid.illegal.s840d_gcode
          set: array-index

        # If nothing else matches mark the tailing whitespace as part of the
        # variable to make auto completion suggest known NCK variables only.
        - match: '[ \t]'
          scope: support.variable.nck.s840d_gcode
          pop: true

###############################################################################
# ARRAY SIZE DEFINITION
# everything withing [ ... ]
###############################################################################

  array-dimension:
    - match: \[
      scope: punctuation.section.brackets.begin.s840d_gcode
      push:
        - meta_scope: meta.brackets.s840d_gcode
        - match: \]
          scope: punctuation.section.brackets.end.s840d_gcode
          set: illegal-brackets-pop
        - include: seperator-comma-minus
        - include: expressions-line
    - include: scope-end

###############################################################################
# ARRAY INDEX
# everything withing [ ... ]
###############################################################################

  array-index:
    - match: \[
      scope: punctuation.section.brackets.begin.s840d_gcode
      set: [array-index-body, after-operator]
    - include: scope-end

  array-index-body:
    - meta_scope: meta.brackets.s840d_gcode
    - match: \]
      scope: punctuation.section.brackets.end.s840d_gcode
      set: illegal-brackets-pop
    - include: seperator-comma-minus
    - include: frame-constants
    - include: trafo-constants
    - include: expressions-line

###############################################################################
# IGNORED NESTED PARENTHESES AND BRAKETS
# expressions withing ( ... ) or [ ... ]
###############################################################################

  ignore-parens:
    - match: \(
      push:
        - match: \)|$
          pop: true
        - include: ignore-parens

  ignore-square:
    - match: \[
      push:
        - match: \]|$
          pop: true
        - include: ignore-square

###############################################################################
# ILLEAGAL
###############################################################################

  illegal:
    - include: illegal-brackets
    - match: \S
      scope: invalid.illegal.s840d_gcode

  illegal-ident:
    - match: \w+
      scope: invalid.illegal.identifier.s840d_gcode
    - include: illegal

  illegal-pop:
    - include: illegal-brackets
    - match: \S+
      scope: invalid.illegal.s840d_gcode
      pop: true

  illegal-brackets-pop:
    - include: illegal-brackets
    - include: scope-end

  illegal-brackets:
    - include: illegal-paren
    - include: illegal-square

  illegal-paren:
    - match: \(
      push:
        - meta_scope: invalid.illegal.group.s840d_gcode
        - match: \)|$
          pop: true
        - include: ignore-parens

  illegal-square:
    - match: \[
      push:
        - meta_scope: invalid.illegal.array.s840d_gcode
        - match: \]|$
          pop: true
        - include: ignore-square

  illegal-keywords:
    # If one of the following keywords has not yet been handled by any
    # other rule, they are used in an illegal context. This rule avoids
    # matching them as procedure call or variable.
    - match: '[Nn]\d+'
      scope: invalid.illegal.iso.s840d_gcode
    - match: (?i:DEF|DEFINE|EXTERN|PROC|REDEF|AS)\b.*
      scope: invalid.illegal.keywords.definition.s840d_gcode
    - match: (?i:BLOCK|CASE|CTAB(?:DEF|END)|DEFAULT|ELSE|(?:END)?(?:IF|FOR|LOOP|WHILE)|ISOCALL|GOTO[BCFS]?|[MP]?CALL|OF|REPEATB?|RET|TO|UNTIL)\b
      scope: invalid.illegal.keywords.control.s840d_gcode
    - match: (?i:AXIS|BOOL|FRAME|INT|REAL|STRING|TR|FI|RT|SC|MI|NCK|CHAN|AP[RWX][BP]?|LL[IU]|PHU|SYN(?:[RW]|RW)|VAR|INI(?:CF|RE|PO)|PRLOC)\b
      scope: invalid.illegal.keywords.storage.s840d_gcode

  illegal-operators:
    - match: (?i:[-+/\*<>=]MOD|DIV|_DEC[1-9]|(?:B_)?(?:AND|OR|XOR|NOT))\b
      scope: invalid.illegal.operator.s840d_gcode
